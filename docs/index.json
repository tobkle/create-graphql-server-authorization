[
  {
    "__docId__": 1,
    "kind": "external",
    "name": "Infinity",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Infinity",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Infinity",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 2,
    "kind": "external",
    "name": "NaN",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/NaN",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~NaN",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 3,
    "kind": "external",
    "name": "undefined",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~undefined",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 4,
    "kind": "external",
    "name": "null",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~null",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 5,
    "kind": "external",
    "name": "Object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Object",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 6,
    "kind": "external",
    "name": "object",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~object",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 7,
    "kind": "external",
    "name": "Function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Function",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 8,
    "kind": "external",
    "name": "function",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~function",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 9,
    "kind": "external",
    "name": "Boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Boolean",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 10,
    "kind": "external",
    "name": "boolean",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~boolean",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 11,
    "kind": "external",
    "name": "Symbol",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Symbol",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 12,
    "kind": "external",
    "name": "Error",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Error",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 13,
    "kind": "external",
    "name": "EvalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/EvalError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~EvalError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 14,
    "kind": "external",
    "name": "InternalError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/InternalError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~InternalError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 15,
    "kind": "external",
    "name": "RangeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RangeError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~RangeError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 16,
    "kind": "external",
    "name": "ReferenceError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ReferenceError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~ReferenceError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 17,
    "kind": "external",
    "name": "SyntaxError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SyntaxError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~SyntaxError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 18,
    "kind": "external",
    "name": "TypeError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypeError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~TypeError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 19,
    "kind": "external",
    "name": "URIError",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/URIError",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~URIError",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 20,
    "kind": "external",
    "name": "Number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Number",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 21,
    "kind": "external",
    "name": "number",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~number",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 22,
    "kind": "external",
    "name": "Date",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Date",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 23,
    "kind": "external",
    "name": "String",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~String",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 24,
    "kind": "external",
    "name": "string",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~string",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 25,
    "kind": "external",
    "name": "RegExp",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~RegExp",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 26,
    "kind": "external",
    "name": "Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 27,
    "kind": "external",
    "name": "Int8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int8Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Int8Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 28,
    "kind": "external",
    "name": "Uint8Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint8Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 29,
    "kind": "external",
    "name": "Uint8ClampedArray",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint8ClampedArray",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 30,
    "kind": "external",
    "name": "Int16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int16Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Int16Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 31,
    "kind": "external",
    "name": "Uint16Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint16Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint16Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 32,
    "kind": "external",
    "name": "Int32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Int32Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Int32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 33,
    "kind": "external",
    "name": "Uint32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Uint32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 34,
    "kind": "external",
    "name": "Float32Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float32Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Float32Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 35,
    "kind": "external",
    "name": "Float64Array",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Float64Array",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Float64Array",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 36,
    "kind": "external",
    "name": "Map",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Map",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 37,
    "kind": "external",
    "name": "Set",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Set",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 38,
    "kind": "external",
    "name": "WeakMap",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakMap",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~WeakMap",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 39,
    "kind": "external",
    "name": "WeakSet",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/WeakSet",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~WeakSet",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 40,
    "kind": "external",
    "name": "ArrayBuffer",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~ArrayBuffer",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 41,
    "kind": "external",
    "name": "DataView",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~DataView",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 42,
    "kind": "external",
    "name": "JSON",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~JSON",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 43,
    "kind": "external",
    "name": "Promise",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Promise",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 44,
    "kind": "external",
    "name": "Generator",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Generator",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Generator",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 45,
    "kind": "external",
    "name": "GeneratorFunction",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/GeneratorFunction",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~GeneratorFunction",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 46,
    "kind": "external",
    "name": "Reflect",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Reflect",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Reflect",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 47,
    "kind": "external",
    "name": "Proxy",
    "externalLink": "https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy",
    "memberof": "src/.external-ecmascript.js",
    "static": true,
    "longname": "src/.external-ecmascript.js~Proxy",
    "access": "public",
    "description": "",
    "builtinExternal": true
  },
  {
    "__docId__": 48,
    "kind": "file",
    "name": "src/__tests__/authlog-test.js",
    "content": "/* eslint-disable max-len */\nimport fs from 'fs';\nimport path from 'path';\n\nimport { authlog } from '../lib/authlog';\nimport { getLogFilename } from '../lib/getLogFilename';\n\nconst assert = require('chai').assert;\nconst expect = require('chai').expect;\n\nconst resolver = 'authlog';\nconst mode = 'testMode';\n\nlet logFilename;\nlet directoryName;\n\ndescribe('authlog', function() {\n  before(function() {\n    logFilename = getLogFilename();\n    expect(logFilename).be.a('string');\n    directoryName = path.dirname(logFilename);\n    try {\n      fs.mkdirSync(directoryName);\n    } catch (err) {\n      if (err.code !== 'EEXIST') {\n        throw err;\n      }\n    }\n  });\n\n  it('should return a function \"error\" and \"debug\"', function() {\n    const log = authlog();\n    expect(log).to.have.property('error');\n    expect(log).to.have.property('debug');\n    assert.isFunction(log.error);\n    assert.isFunction(log.debug);\n  });\n\n  it('function log.debug should return: \"Authorize testMode \"authlog\" with user \"<no-user>\" hello log.debug\"', function() {\n    const log = authlog(resolver, mode);\n    const message = 'hello log.debug';\n\n    let result = '';\n    const testFunction = function() {\n      result = log.debug(message);\n      return result;\n    };\n    expect(testFunction).to.not.throw();\n    expect(result).to.match(\n      /Authorize testMode 'authlog' with user '<no-user>' hello log\\.debug/\n    );\n  });\n\n  it('function log.debug should return: \"Authorize testMode \"authlog\" with user \"tobkle\" hello log.debug\"', function() {\n    const me = {\n      username: 'tobkle',\n      email: 'test@example.com'\n    };\n    const log = authlog(resolver, mode, me);\n    const message = 'hello log.debug';\n\n    let result = '';\n    const testFunction = function() {\n      result = log.debug(message);\n      return result;\n    };\n    expect(testFunction).to.not.throw();\n    expect(result).to.match(\n      /Authorize testMode 'authlog' with user 'tobkle' hello log\\.debug/\n    );\n  });\n\n  it('function log.error should throw exception and return: ERROR Authorize testMode \"authlog\" with user \"<no-user>\" test-error', function() {\n    const me = {};\n    const log = authlog(resolver, mode, me);\n    const message = 'test-error';\n\n    const testFunction = function() {\n      log.error(message);\n    };\n    expect(testFunction).to.throw(message);\n  });\n});\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/__tests__/authlog-test.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 49,
    "kind": "variable",
    "name": "assert",
    "memberof": "src/__tests__/authlog-test.js",
    "static": true,
    "longname": "src/__tests__/authlog-test.js~assert",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/authlog-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 50,
    "kind": "variable",
    "name": "expect",
    "memberof": "src/__tests__/authlog-test.js",
    "static": true,
    "longname": "src/__tests__/authlog-test.js~expect",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/authlog-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 9,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 51,
    "kind": "variable",
    "name": "resolver",
    "memberof": "src/__tests__/authlog-test.js",
    "static": true,
    "longname": "src/__tests__/authlog-test.js~resolver",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/authlog-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 52,
    "kind": "variable",
    "name": "mode",
    "memberof": "src/__tests__/authlog-test.js",
    "static": true,
    "longname": "src/__tests__/authlog-test.js~mode",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/authlog-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 53,
    "kind": "file",
    "name": "src/__tests__/checkAuthDoc-test.js",
    "content": "/* eslint-disable max-len */\nimport { authlog } from '../lib/authlog';\nimport { checkAuthDoc } from '../lib/checkAuthDoc';\nimport { dummyUserContext } from '../lib/dummyUserContext';\n\nconst expect = require('chai').expect;\nconst assert = require('chai').assert;\n\n// mocking User authRole, as it is not existing in this library\nconst User = dummyUserContext;\n\nconst resolver = 'checkAuth';\nconst mode = 'testMode';\nconst doc = {\n  _id: { $oid: '583676d3618530145474e352' },\n  authorId: { $oid: '583291a1638566b3c5a92ca1' },\n  otherExistingField: { $oid: '583291a1638566b3c5a91111' },\n  secret: 'password'\n};\n\nconst not_authorized = 'is not authorized';\n\n// Call pattern:\n// checkAuthDoc(docToInsert, me, ['admin'], ['_id'], { User: this.context.User }, authlog(resolver, 'create', me));\n\ndescribe('checkAuthDoc', function() {\n  it('should NOT authorize on empty me, empty userRoles, empty docRoles', function() {\n    const userRoles = [];\n    const docRoles = [];\n    const me = {};\n\n    let result = {};\n    const testFunction = function() {\n      result = checkAuthDoc(\n        doc,\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should NOT authorize on empty me, empty userRoles, docRoles: [\"authorId\"]', function() {\n    const userRoles = [];\n    const docRoles = ['authorId'];\n    const me = {};\n\n    let result = {};\n    const testFunction = function() {\n      result = checkAuthDoc(\n        doc,\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should NOT authorize on empty me, userRoles: [\"admin\"], empty docRoles', function() {\n    const userRoles = ['admin'];\n    const docRoles = [];\n    const me = {};\n\n    let result = {};\n    const testFunction = function() {\n      result = checkAuthDoc(\n        doc,\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should NOT authorize on me: \"tobkle\", empty userRoles, empty docRoles', function() {\n    const userRoles = [];\n    const docRoles = [];\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle'\n    };\n\n    let result = {};\n    const testFunction = function() {\n      result = checkAuthDoc(\n        doc,\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should NOT authorize on me.role: \"admin\", but empty userRoles, empty docRoles', function() {\n    const userRoles = [];\n    const docRoles = [];\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n\n    let result = {};\n    const testFunction = function() {\n      result = checkAuthDoc(\n        doc,\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should not authorize on me.role: \"admin\" and userRoles: [\"superadmin\"]', function() {\n    const userRoles = ['superadmin'];\n    const docRoles = [];\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n\n    let result = {};\n    const testFunction = function() {\n      result = checkAuthDoc(\n        doc,\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should authorize on me.role=\"admin\" and userRoles: [\"admin\"]', function() {\n    const userRoles = ['admin'];\n    const docRoles = [];\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n\n    let result = {};\n    const testFunction = function() {\n      result = checkAuthDoc(\n        doc,\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n    expect(testFunction).to.not.throw();\n    assert.isObject(result);\n    assert.property(result, 'secret');\n    expect(result.secret).to.equal('password');\n  });\n\n  it('should not authorize on docRoles: [\"notExistingField\"]', function() {\n    const userRoles = [];\n    const docRoles = ['notExistingField'];\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n\n    let result = {};\n    const testFunction = function() {\n      result = checkAuthDoc(\n        doc,\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should not authorize on docRoles: [\"otherExistingField\"] but other me._id', function() {\n    const userRoles = [];\n    const docRoles = ['otherExistingField'];\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n\n    let result = {};\n    const testFunction = function() {\n      result = checkAuthDoc(\n        doc,\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should not authorize on docRoles: [\"authorId\"] but other me._id', function() {\n    const userRoles = [];\n    const docRoles = ['authorId'];\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92000' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n\n    let result = {};\n    const testFunction = function() {\n      result = checkAuthDoc(\n        doc,\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should authorize on docRoles: [\"authorId\"] and (me._id === doc.authorId)', function() {\n    const userRoles = [];\n    const docRoles = ['authorId'];\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n\n    let result = {};\n    const testFunction = function() {\n      result = checkAuthDoc(\n        doc,\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n    expect(testFunction).to.not.throw();\n    assert.isObject(result);\n    assert.property(result, 'secret');\n    expect(result.secret).to.equal('password');\n  });\n});\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/__tests__/checkAuthDoc-test.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 54,
    "kind": "variable",
    "name": "expect",
    "memberof": "src/__tests__/checkAuthDoc-test.js",
    "static": true,
    "longname": "src/__tests__/checkAuthDoc-test.js~expect",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/checkAuthDoc-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 6,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 55,
    "kind": "variable",
    "name": "assert",
    "memberof": "src/__tests__/checkAuthDoc-test.js",
    "static": true,
    "longname": "src/__tests__/checkAuthDoc-test.js~assert",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/checkAuthDoc-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 7,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 56,
    "kind": "variable",
    "name": "User",
    "memberof": "src/__tests__/checkAuthDoc-test.js",
    "static": true,
    "longname": "src/__tests__/checkAuthDoc-test.js~User",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/checkAuthDoc-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 10,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 57,
    "kind": "variable",
    "name": "resolver",
    "memberof": "src/__tests__/checkAuthDoc-test.js",
    "static": true,
    "longname": "src/__tests__/checkAuthDoc-test.js~resolver",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/checkAuthDoc-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 58,
    "kind": "variable",
    "name": "mode",
    "memberof": "src/__tests__/checkAuthDoc-test.js",
    "static": true,
    "longname": "src/__tests__/checkAuthDoc-test.js~mode",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/checkAuthDoc-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 59,
    "kind": "variable",
    "name": "doc",
    "memberof": "src/__tests__/checkAuthDoc-test.js",
    "static": true,
    "longname": "src/__tests__/checkAuthDoc-test.js~doc",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/checkAuthDoc-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 14,
    "undocument": true,
    "type": {
      "types": [
        "{\"_id\": *, \"authorId\": *, \"otherExistingField\": *, \"secret\": string}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 60,
    "kind": "variable",
    "name": "not_authorized",
    "memberof": "src/__tests__/checkAuthDoc-test.js",
    "static": true,
    "longname": "src/__tests__/checkAuthDoc-test.js~not_authorized",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/checkAuthDoc-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 21,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 61,
    "kind": "file",
    "name": "src/__tests__/fieldContainsUserId-test.js",
    "content": "/* eslint-disable max-len */\n/* eslint-disable no-unused-expressions */\nimport ObjectId from 'bson-objectid';\n\nimport { fieldContainsUserId } from '../lib/fieldContainsUserId';\n\nconst expect = require('chai').expect;\n\ndescribe('fieldContainsUserId', function() {\n  it('should return false on empty call', function() {\n    const result = fieldContainsUserId();\n    expect(result).to.be.false;\n  });\n\n  it('should return false on empty docRoleField Array', function() {\n    const docRoleField = [];\n    const userId = '';\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.false;\n  });\n\n  it('should return false on empty docRoleField Object', function() {\n    const docRoleField = {};\n    const userId = '';\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.false;\n  });\n\n  it('should return false on docRoleField Array with element \"\"', function() {\n    const docRoleField = [''];\n    const userId = '';\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.false;\n  });\n\n  it('should return false on docRoleField Object field: \"\"', function() {\n    const docRoleField = {\n      field: ''\n    };\n    const userId = '';\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.false;\n  });\n\n  it('should return false on empty docRoleField String and empty userId String', function() {\n    const docRoleField = '';\n    const userId = '';\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.false;\n  });\n\n  it('should return false on empty docRoleField but userId String', function() {\n    const docRoleField = [];\n    const userId = '583291a1638566b3c5a92ca1';\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.false;\n  });\n\n  it('should return false on empty docRoleField but userId Object', function() {\n    const docRoleField = [];\n    const userId = {\n      $oid: '583291a1638566b3c5a92ca1'\n    };\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.false;\n  });\n\n  it('should return true on docRoleField String = userId String', function() {\n    const docRoleField = '583291a1638566b3c5a92ca1';\n    const userId = '583291a1638566b3c5a92ca1';\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.true;\n  });\n\n  it('should return true on docRoleField Array = userId String', function() {\n    const docRoleField = ['583291a1638566b3c5a92ca1'];\n    const userId = '583291a1638566b3c5a92ca1';\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.true;\n  });\n\n  it('should return true on docRoleField Object with fields = userId String', function() {\n    const docRoleField = {\n      field1: '583291a1638566b3c5a92ca1',\n      field2: 'xxx'\n    };\n    const userId = '583291a1638566b3c5a92ca1';\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.true;\n  });\n\n  it('should return true on docRoleField field Object Array = userId String', function() {\n    const docRoleField = [\n      {\n        field0: 'xxx'\n      },\n      {\n        field1: '583291a1638566b3c5a92ca1'\n      },\n      {\n        field2: 'xxx'\n      }\n    ];\n    const userId = '583291a1638566b3c5a92ca1';\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.true;\n  });\n\n  it('should return true on docRoleField Object with fields = userId Object', function() {\n    const docRoleField = {\n      field1: '583291a1638566b3c5a92ca1',\n      field2: 'xxx'\n    };\n    const userId = {\n      $oid: '583291a1638566b3c5a92ca1'\n    };\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.true;\n  });\n\n  it('should return true on docRoleField Object with fields and IdObject = userId Object', function() {\n    const docRoleField = {\n      field1: {\n        $oid: '583291a1638566b3c5a92ca1'\n      },\n      field2: {\n        $oid: '583291a1638566b3c5a9000'\n      }\n    };\n    const userId = {\n      $oid: '583291a1638566b3c5a92ca1'\n    };\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.true;\n  });\n\n  it('should return true on docRoleField field Object Array = userId Object', function() {\n    const docRoleField = [\n      {\n        field0: 'xxx'\n      },\n      {\n        field1: '583291a1638566b3c5a92ca1'\n      },\n      {\n        field2: 'xxx'\n      }\n    ];\n    const userId = {\n      $oid: '583291a1638566b3c5a92ca1'\n    };\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.true;\n  });\n\n  it('should return true on docRoleField field Object Array = userId Object', function() {\n    const docRoleField = [\n      {\n        field0: {\n          $oid: '583291a1638566b3c5a90000'\n        }\n      },\n      {\n        field1: {\n          $oid: '583291a1638566b3c5a92ca1'\n        }\n      },\n      {\n        field2: {\n          $oid: '583291a1638566b3c5a90000'\n        }\n      }\n    ];\n    const userId = {\n      $oid: '583291a1638566b3c5a92ca1'\n    };\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.true;\n  });\n\n  it('should return true on docRoleField Object with ObjectID fields = userId Object', function() {\n    const docRoleField = {\n      field1: ObjectId('583291a1638566b3c5a92ca1'),\n      field2: ObjectId('583291a1638566b3c5a90000')\n    };\n    const userId = ObjectId('583291a1638566b3c5a92ca1');\n    const result = fieldContainsUserId(docRoleField, userId);\n    expect(result).to.be.true;\n  });\n});\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/__tests__/fieldContainsUserId-test.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 62,
    "kind": "variable",
    "name": "expect",
    "memberof": "src/__tests__/fieldContainsUserId-test.js",
    "static": true,
    "longname": "src/__tests__/fieldContainsUserId-test.js~expect",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/fieldContainsUserId-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 7,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 63,
    "kind": "file",
    "name": "src/__tests__/findByIds-test.js",
    "content": "/* eslint-disable max-len */\nimport DataLoader from 'dataloader';\nimport mongodb from 'mongo-mock';\nimport ObjectId from 'bson-objectid';\n\nimport { findByIds } from '../lib/findByIds';\n\nconst assert = require('chai').assert;\n\nmongodb.max_delay = 0; // you can choose to NOT pretend to be async (default is 400ms)\nconst MongoClient = mongodb.MongoClient;\nMongoClient.persist = 'log/mongo-mock.db.js'; // persist the data to disk\nconst url = 'mongodb://localhost:27017/myproject';\n\nlet collection;\n\ndescribe('findByIds', function() {\n  before(function(done) {\n    MongoClient.connect(url, {}, function(err, db) {\n      const docs = [\n        {\n          _id: ObjectId('583291a1638566b3c5a92ca0'),\n          username: 'tmeasday'\n        },\n        {\n          _id: ObjectId('583291a1638566b3c5a92ca1'),\n          username: 'stubailo'\n        },\n        {\n          _id: ObjectId('583291a1638566b3c5a92ca2'),\n          username: 'lacker'\n        }\n      ];\n      collection = db.collection('user');\n      collection.insert(docs, function(error, result) {\n        if (error || result) {\n          done();\n        }\n      });\n    });\n  });\n\n  it('cannot get any user profile with id: \"\"', async function() {\n    // const id = '';\n    // const authQuery = {};\n    // const loader = new DataLoader(ids => findByIds(collection, ids, authQuery));\n    // const result = await loader.load(id);\n    // assert.isUndefined(result);\n  });\n\n  it('can get user profile \"stubailo\" with id: ObjectId(\"583291a1638566b3c5a92ca1\")', async function() {\n    const id = ObjectId('583291a1638566b3c5a92ca1');\n    const authQuery = {};\n    const loader = new DataLoader(ids => findByIds(collection, ids, authQuery));\n    const result = await loader.load(id);\n    assert.isObject(result);\n    // assert.equal(result.username, 'stubailo');\n  });\n\n  it('can get user profile \"stubailo\" with id: ObjectId(\"583291a1638566b3c5a92ca1\") and authQuery: { \"username\" : \"stubailo\" }', async function() {\n    const id = ObjectId('583291a1638566b3c5a92ca1');\n    const authQuery = {\n      username: 'stubailo'\n    };\n    const loader = new DataLoader(ids => findByIds(collection, ids, authQuery));\n    const result = await loader.load(id);\n    assert.isObject(result);\n    // assert.equal(result.username, 'stubailo');\n  });\n\n  it('cannot get user profile \"stubailo\" with id: ObjectId(\"583291a1638566b3c5a92ca1\") and me.username = \"lacker\"', async function() {\n    // const id = ObjectId('583291a1638566b3c5a92ca1');\n    // const me = {\n    //   _id: ObjectId('583291a1638566b3c5a92ca2'),\n    //   username: 'lacker'\n    // };\n    // const authQuery = queryForRoles(\n    //   me,\n    //   [],\n    //   ['_id'],\n    //   { User },\n    //   authlog('findByIds', 'testMode', me)\n    // );\n    // const loader = new DataLoader(ids => findByIds(collection, ids, authQuery));\n    // const result = await loader.load(id);\n    // assert.isUndefined(result);\n  });\n});\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/__tests__/findByIds-test.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 64,
    "kind": "variable",
    "name": "assert",
    "memberof": "src/__tests__/findByIds-test.js",
    "static": true,
    "longname": "src/__tests__/findByIds-test.js~assert",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/findByIds-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 65,
    "kind": "variable",
    "name": "MongoClient",
    "memberof": "src/__tests__/findByIds-test.js",
    "static": true,
    "longname": "src/__tests__/findByIds-test.js~MongoClient",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/findByIds-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 66,
    "kind": "variable",
    "name": "url",
    "memberof": "src/__tests__/findByIds-test.js",
    "static": true,
    "longname": "src/__tests__/findByIds-test.js~url",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/findByIds-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 67,
    "kind": "file",
    "name": "src/__tests__/getLogFilename-test.js",
    "content": "/* eslint-disable max-len */\nimport { getLogFilename } from '../lib/getLogFilename';\n\nconst expect = require('chai').expect;\n\ndescribe('getLogFilename', function() {\n  it('to return a logFilename', function() {\n    const logFilename = getLogFilename();\n    expect(logFilename).be.a('string');\n  });\n});\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/__tests__/getLogFilename-test.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 68,
    "kind": "variable",
    "name": "expect",
    "memberof": "src/__tests__/getLogFilename-test.js",
    "static": true,
    "longname": "src/__tests__/getLogFilename-test.js~expect",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/getLogFilename-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 4,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 69,
    "kind": "file",
    "name": "src/__tests__/index-test.js",
    "content": "/* eslint-disable max-len */\nimport fs from 'fs';\nimport path from 'path';\nimport chai, { expect } from 'chai';\nchai.use(require('chai-fs'));\n\nconst indexFile = path.join(__dirname, '/../index.js');\n\ndescribe('index', function() {\n  it('should return an object with with all functions', function() {\n    const ls = fs.readdirSync(path.join(__dirname, '/../lib'));\n    ls.forEach(filename => {\n      const file = path.parse(filename);\n      if (file.ext === '.js') {\n        const objectName = file.name;\n        const objectNameRegEx = new RegExp(`${objectName}`, 'g');\n        expect(indexFile).to.have.content.that.match(\n          objectNameRegEx,\n          `${objectName} must be in src/index.js file`\n        );\n      }\n    });\n  });\n});\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/__tests__/index-test.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 70,
    "kind": "variable",
    "name": "indexFile",
    "memberof": "src/__tests__/index-test.js",
    "static": true,
    "longname": "src/__tests__/index-test.js~indexFile",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/index-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 7,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 71,
    "kind": "file",
    "name": "src/__tests__/loggedIn-test.js",
    "content": "/* eslint-disable max-len */\nimport ObjectId from 'bson-objectid';\n\nimport { loggedIn } from '../lib/loggedIn';\n\nconst assert = require('chai').assert;\n\ndescribe('loggedIn', function() {\n  it('should return false, if not logged in', function() {\n    const me = {};\n    const result = loggedIn(me);\n    assert.isFalse(result);\n  });\n\n  it('should return true, if logged in', function() {\n    const me = {\n      _id: ObjectId('583291a1638566b3c5a92ca0'),\n      username: 'tmeasday'\n    };\n    const result = loggedIn(me);\n    assert.isTrue(result);\n  });\n});\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/__tests__/loggedIn-test.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 72,
    "kind": "variable",
    "name": "assert",
    "memberof": "src/__tests__/loggedIn-test.js",
    "static": true,
    "longname": "src/__tests__/loggedIn-test.js~assert",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/loggedIn-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 6,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 73,
    "kind": "file",
    "name": "src/__tests__/logger-test.js",
    "content": "/* eslint-disable max-len */\nimport { getLogFilename } from '../lib/getLogFilename';\nimport { logger } from '../lib/logger';\n\nconst expect = require('chai').expect;\n\nlet logFilename;\n\ndescribe('logger', function() {\n  before(function() {\n    logFilename = getLogFilename();\n    expect(logFilename).be.a('string');\n  });\n\n  it('should return a function with \"log\"', function() {\n    const result = logger(logFilename);\n    expect(result).to.have.property('log');\n  });\n\n  // This is tested more in depth in test/authlog.js\n});\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/__tests__/logger-test.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 74,
    "kind": "variable",
    "name": "expect",
    "memberof": "src/__tests__/logger-test.js",
    "static": true,
    "longname": "src/__tests__/logger-test.js~expect",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/logger-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 75,
    "kind": "file",
    "name": "src/__tests__/protectFields-test.js",
    "content": "/* eslint-disable max-len */\nimport { protectFields } from '../lib/protectFields';\nimport { dummyUserContext } from '../lib/dummyUserContext';\n\nconst assert = require('chai').assert;\n\n// mocking User authRole, as it is not existing in this library\nconst User = dummyUserContext;\n\nconst inputObject = {\n  _id: { $oid: '583676d3618530145474e350' },\n  authorId: { $oid: '583291a1638566b3c5a92ca0' },\n  coauthorsIds: [\n    { $oid: '583291a1638566b3c5a92ca1' },\n    { $oid: '583291a1638566b3c5a92ca2' }\n  ],\n  body:\n    'A #graphql-first development workflow based on real world lessons, from @danimman \\u0026 @stubailo:',\n  createdAt: 1.479964340853e12,\n  updatedAt: 1.479964340853e12,\n  createdById: { $oid: '583291a1638566b3c5a92ca1' },\n  updatedById: { $oid: '583291a1638566b3c5a92ca1' },\n  secret: 'password'\n};\n\ndescribe('protectFields', function() {\n  it('on no proctectedFields, inputObject should be equal to resultObject', function() {\n    const me = {};\n    const authorizedUserRoles = [];\n    const protectedFields = [];\n\n    const result = protectFields(\n      me,\n      authorizedUserRoles,\n      protectedFields,\n      inputObject,\n      { User }\n    );\n\n    assert.isObject(result);\n    assert.deepEqual(inputObject, result);\n  });\n\n  it('on proctectedFields: [\"secret\"], outputObject (without \"secret\") should be equal to resultObject', function() {\n    const me = {};\n    const authorizedUserRoles = [];\n    const protectedFields = ['secret'];\n    const outputObject = {\n      _id: { $oid: '583676d3618530145474e350' },\n      authorId: { $oid: '583291a1638566b3c5a92ca0' },\n      coauthorsIds: [\n        { $oid: '583291a1638566b3c5a92ca1' },\n        { $oid: '583291a1638566b3c5a92ca2' }\n      ],\n      body:\n        'A #graphql-first development workflow based on real world lessons, from @danimman \\u0026 @stubailo:',\n      createdAt: 1.479964340853e12,\n      updatedAt: 1.479964340853e12,\n      createdById: { $oid: '583291a1638566b3c5a92ca1' },\n      updatedById: { $oid: '583291a1638566b3c5a92ca1' }\n    };\n\n    const result = protectFields(\n      me,\n      authorizedUserRoles,\n      protectedFields,\n      inputObject,\n      { User }\n    );\n\n    assert.isObject(result);\n    assert.deepEqual(outputObject, result);\n  });\n\n  it('on proctectedFields: [\"secret\", \"authorId\"], outputObject (without \"secret\", \"authorId\") should be equal to resultObject', function() {\n    const me = {};\n    const authorizedUserRoles = [];\n    const protectedFields = ['secret', 'authorId'];\n    const outputObject = {\n      _id: { $oid: '583676d3618530145474e350' },\n      coauthorsIds: [\n        { $oid: '583291a1638566b3c5a92ca1' },\n        { $oid: '583291a1638566b3c5a92ca2' }\n      ],\n      body:\n        'A #graphql-first development workflow based on real world lessons, from @danimman \\u0026 @stubailo:',\n      createdAt: 1.479964340853e12,\n      updatedAt: 1.479964340853e12,\n      createdById: { $oid: '583291a1638566b3c5a92ca1' },\n      updatedById: { $oid: '583291a1638566b3c5a92ca1' }\n    };\n\n    const result = protectFields(\n      me,\n      authorizedUserRoles,\n      protectedFields,\n      inputObject,\n      { User }\n    );\n\n    assert.isObject(result);\n    assert.deepEqual(outputObject, result);\n  });\n\n  it('if all fields are proctectedFields, empty object {} should be equal to resultObject', function() {\n    const me = {};\n    const authorizedUserRoles = [];\n    const protectedFields = [\n      '_id',\n      'authorId',\n      'coauthorsIds',\n      'body',\n      'createdAt',\n      'updatedAt',\n      'createdById',\n      'updatedById',\n      'secret'\n    ];\n    const outputObject = {};\n\n    const result = protectFields(\n      me,\n      authorizedUserRoles,\n      protectedFields,\n      inputObject,\n      { User }\n    );\n\n    assert.isObject(result);\n    assert.deepEqual(outputObject, result);\n  });\n\n  it('on proctectedFields: [\"secret\"] and authorized User, resultObject should include field \"secret\"', function() {\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tmeasday',\n      role: 'admin'\n    };\n    const authorizedUserRoles = ['admin'];\n    const protectedFields = ['secret'];\n    const outputObject = {\n      _id: { $oid: '583676d3618530145474e350' },\n      authorId: { $oid: '583291a1638566b3c5a92ca0' },\n      coauthorsIds: [\n        { $oid: '583291a1638566b3c5a92ca1' },\n        { $oid: '583291a1638566b3c5a92ca2' }\n      ],\n      body:\n        'A #graphql-first development workflow based on real world lessons, from @danimman \\u0026 @stubailo:',\n      createdAt: 1.479964340853e12,\n      updatedAt: 1.479964340853e12,\n      createdById: { $oid: '583291a1638566b3c5a92ca1' },\n      updatedById: { $oid: '583291a1638566b3c5a92ca1' },\n      secret: 'password'\n    };\n\n    const result = protectFields(\n      me,\n      authorizedUserRoles,\n      protectedFields,\n      inputObject,\n      { User }\n    );\n\n    assert.isObject(result);\n    assert.deepEqual(outputObject, result);\n  });\n\n  it('on proctectedFields: [\"secret\", \"authorId\"] and authorized User, resultObject should include field \"secret\" and \"authorId\"', function() {\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tmeasday',\n      role: 'admin'\n    };\n    const authorizedUserRoles = ['admin'];\n    const protectedFields = ['secret', 'authorId'];\n    const outputObject = {\n      _id: { $oid: '583676d3618530145474e350' },\n      authorId: { $oid: '583291a1638566b3c5a92ca0' },\n      coauthorsIds: [\n        { $oid: '583291a1638566b3c5a92ca1' },\n        { $oid: '583291a1638566b3c5a92ca2' }\n      ],\n      body:\n        'A #graphql-first development workflow based on real world lessons, from @danimman \\u0026 @stubailo:',\n      createdAt: 1.479964340853e12,\n      updatedAt: 1.479964340853e12,\n      createdById: { $oid: '583291a1638566b3c5a92ca1' },\n      updatedById: { $oid: '583291a1638566b3c5a92ca1' },\n      secret: 'password'\n    };\n\n    const result = protectFields(\n      me,\n      authorizedUserRoles,\n      protectedFields,\n      inputObject,\n      { User }\n    );\n\n    assert.isObject(result);\n    assert.deepEqual(outputObject, result);\n  });\n});\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/__tests__/protectFields-test.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 76,
    "kind": "variable",
    "name": "assert",
    "memberof": "src/__tests__/protectFields-test.js",
    "static": true,
    "longname": "src/__tests__/protectFields-test.js~assert",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/protectFields-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 77,
    "kind": "variable",
    "name": "User",
    "memberof": "src/__tests__/protectFields-test.js",
    "static": true,
    "longname": "src/__tests__/protectFields-test.js~User",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/protectFields-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 78,
    "kind": "variable",
    "name": "inputObject",
    "memberof": "src/__tests__/protectFields-test.js",
    "static": true,
    "longname": "src/__tests__/protectFields-test.js~inputObject",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/protectFields-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 10,
    "undocument": true,
    "type": {
      "types": [
        "{\"_id\": *, \"authorId\": *, \"coauthorsIds\": *, \"body\": string, \"createdAt\": number, \"updatedAt\": number, \"createdById\": *, \"updatedById\": *, \"secret\": string}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 79,
    "kind": "file",
    "name": "src/__tests__/queryForRoles-test.js",
    "content": "/* eslint-disable max-len */\nimport { queryForRoles } from '../lib/queryForRoles';\nimport { dummyUserContext } from '../lib/dummyUserContext';\nimport { authlog } from '../lib/authlog';\n\nconst expect = require('chai').expect;\nconst assert = require('chai').assert;\n\n// mocking User authRole, as it is not existing in this library\nconst User = dummyUserContext;\nconst mode = 'testMode';\nconst not_authorized = 'is not authorized';\n\ndescribe('queryForRoles', function() {\n  it('should throw an exception on empty call', function() {\n    const resolver = 'queryForRoles-01';\n    const me = {};\n    const userRoles = [];\n    const docRoles = [];\n\n    let result = {};\n    const testFunction = function() {\n      result = queryForRoles(\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should throw an exception on insufficent authorization data', function() {\n    const resolver = 'queryForRoles-02';\n    const me = {};\n    const userRoles = [];\n    const docRoles = [];\n\n    let result = {};\n    const testFunction = function() {\n      result = queryForRoles(\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should throw an exception if not authorized by userRoles or docRoles', function() {\n    const resolver = 'queryForRoles-03';\n    const me = {};\n    const userRoles = ['admin', 'super'];\n    const docRoles = ['authorId', 'coauthorsIds'];\n\n    let result = {};\n    const testFunction = function() {\n      result = queryForRoles(\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should NOT authorize on userRoles: [\"super\", admin\"] and me.role: \"other\"', function() {\n    const resolver = 'queryForRoles-04';\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'other'\n    };\n    const userRoles = ['admin', 'super'];\n    const docRoles = [];\n\n    let result = {};\n    const testFunction = function() {\n      result = queryForRoles(\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n\n    expect(testFunction).to.throw(not_authorized);\n  });\n\n  it('should authorize on userRoles: [\"admin\"] and me.role: \"admin\"', function() {\n    const resolver = 'queryForRoles-05';\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n    const userRoles = ['admin'];\n    const docRoles = [];\n\n    let result = {};\n    const testFunction = function() {\n      result = queryForRoles(\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n\n    const expectedResult = {};\n\n    expect(testFunction).to.not.throw();\n    assert.deepEqual(result, expectedResult);\n  });\n\n  it('should authorize on userRoles: [\"super\", admin\"] and me.role: \"admin\"', function() {\n    const resolver = 'queryForRoles-06';\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n    const userRoles = ['super', 'admin'];\n    const docRoles = [];\n\n    let result = {};\n    const testFunction = function() {\n      result = queryForRoles(\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n\n    const expectedResult = {};\n\n    expect(testFunction).to.not.throw();\n    assert.deepEqual(result, expectedResult);\n  });\n\n  it('should authorize on docRoles: [\"authorId\"] with authQuery: { $or: [ {\"authorId\" : me._id } ] }', function() {\n    const resolver = 'queryForRoles-07';\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n    const userRoles = [];\n    const docRoles = ['authorId'];\n\n    let result = {};\n    const testFunction = function() {\n      result = queryForRoles(\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n\n    const expectedResult = {\n      $or: [\n        {\n          authorId: { $oid: '583291a1638566b3c5a92ca1' }\n        }\n      ]\n    };\n\n    expect(testFunction).to.not.throw();\n    assert.deepEqual(result, expectedResult);\n  });\n\n  it('should authorize on docRoles: [\"authorId\"] with authQuery: { $or: [ {\"authorId\": me._id }, { \"coAuthorsIds\": me._id } ] }', function() {\n    const resolver = 'queryForRoles-08';\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n    const userRoles = [];\n    const docRoles = ['authorId', 'coauthorsIds'];\n\n    let result = {};\n    const testFunction = function() {\n      result = queryForRoles(\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n\n    const expectedResult = {\n      $or: [\n        {\n          authorId: { $oid: '583291a1638566b3c5a92ca1' }\n        },\n        {\n          coauthorsIds: { $oid: '583291a1638566b3c5a92ca1' }\n        }\n      ]\n    };\n\n    expect(testFunction).to.not.throw();\n    assert.deepEqual(result, expectedResult);\n  });\n\n  it('should authorize on userRoles: [\"super\", admin\"] and me.role: \"admin\" and docRoles: [\"authorId\"]', function() {\n    const resolver = 'queryForRoles-09';\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n    const userRoles = ['admin'];\n    const docRoles = ['authorId'];\n\n    let result = {};\n    const testFunction = function() {\n      result = queryForRoles(\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n\n    const expectedResult = {};\n\n    expect(testFunction).to.not.throw();\n    assert.deepEqual(result, expectedResult);\n  });\n\n  it('should authorize on userRoles: [\"super\", admin\"] and me.role: \"admin\" and docRoles: [\"authorId\"]', function() {\n    const resolver = 'queryForRoles-10';\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tobkle',\n      role: 'admin'\n    };\n    const userRoles = ['super', 'admin'];\n    const docRoles = ['authorId', 'coAuthorsIds'];\n\n    let result = {};\n    const testFunction = function() {\n      result = queryForRoles(\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n\n    const expectedResult = {};\n\n    expect(testFunction).to.not.throw();\n    assert.deepEqual(result, expectedResult);\n  });\n\n  it('should authorize on userRoles: [\"world\"]', function() {\n    const resolver = 'queryForRoles-11';\n    const me = {};\n    const userRoles = ['world'];\n    const docRoles = [];\n\n    let result = {};\n    const testFunction = function() {\n      result = queryForRoles(\n        me,\n        userRoles,\n        docRoles,\n        { User },\n        authlog(resolver, mode, me)\n      );\n      return result;\n    };\n\n    const expectedResult = {};\n\n    expect(testFunction).to.not.throw();\n    assert.deepEqual(result, expectedResult);\n  });\n});\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/__tests__/queryForRoles-test.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 80,
    "kind": "variable",
    "name": "expect",
    "memberof": "src/__tests__/queryForRoles-test.js",
    "static": true,
    "longname": "src/__tests__/queryForRoles-test.js~expect",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/queryForRoles-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 6,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 81,
    "kind": "variable",
    "name": "assert",
    "memberof": "src/__tests__/queryForRoles-test.js",
    "static": true,
    "longname": "src/__tests__/queryForRoles-test.js~assert",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/queryForRoles-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 7,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 82,
    "kind": "variable",
    "name": "User",
    "memberof": "src/__tests__/queryForRoles-test.js",
    "static": true,
    "longname": "src/__tests__/queryForRoles-test.js~User",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/queryForRoles-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 10,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 83,
    "kind": "variable",
    "name": "mode",
    "memberof": "src/__tests__/queryForRoles-test.js",
    "static": true,
    "longname": "src/__tests__/queryForRoles-test.js~mode",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/queryForRoles-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 84,
    "kind": "variable",
    "name": "not_authorized",
    "memberof": "src/__tests__/queryForRoles-test.js",
    "static": true,
    "longname": "src/__tests__/queryForRoles-test.js~not_authorized",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/queryForRoles-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 85,
    "kind": "file",
    "name": "src/__tests__/userRoleAuthorized-test.js",
    "content": "/* eslint-disable max-len */\nimport { userRoleAuthorized } from '../lib/userRoleAuthorized';\nimport { dummyUserContext } from '../lib/dummyUserContext';\nimport { authlog } from '../lib/authlog';\n\nconst assert = require('chai').assert;\n\n// mocking User authRole, as it is not existing in this library\nconst User = dummyUserContext;\nconst resolver = 'userRoleAuthorized';\nconst mode = 'testMode';\n\ndescribe('userRoleAuthorized', function() {\n  it('should return false, on empty call', function() {\n    const result = userRoleAuthorized();\n\n    assert.isFalse(result);\n  });\n\n  it('should return false, on empty variables', function() {\n    const me = {};\n    const userRoles = [];\n\n    const result = userRoleAuthorized(\n      me,\n      userRoles,\n      { User },\n      authlog(resolver, mode, me)\n    );\n\n    assert.isFalse(result);\n  });\n\n  it('should return false, if userRole is empty', function() {\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tmeasday',\n      role: 'admin'\n    };\n    const userRoles = [];\n\n    const result = userRoleAuthorized(\n      me,\n      userRoles,\n      { User },\n      authlog(resolver, mode, me)\n    );\n\n    assert.isFalse(result);\n  });\n\n  it('should return false, if userRole \"admin\" is not authorized with userRole \"super\"', function() {\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tmeasday',\n      role: 'admin'\n    };\n    const userRoles = ['super'];\n\n    const result = userRoleAuthorized(\n      me,\n      userRoles,\n      { User },\n      authlog(resolver, mode, me)\n    );\n\n    assert.isFalse(result);\n  });\n\n  it('should return true, if userRole \"admin\" is authorized by me.role: \"admin\"', function() {\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tmeasday',\n      role: 'admin'\n    };\n    const userRoles = ['admin'];\n\n    const result = userRoleAuthorized(\n      me,\n      userRoles,\n      { User },\n      authlog(resolver, mode, me)\n    );\n\n    assert.isTrue(result);\n  });\n\n  it('should return true, if userRoles: [\"super\", \"admin\"] is authorized by me.role: \"admin\"', function() {\n    const me = {\n      _id: { $oid: '583291a1638566b3c5a92ca1' },\n      username: 'tmeasday',\n      role: 'admin'\n    };\n    const userRoles = ['super', 'admin'];\n\n    const result = userRoleAuthorized(\n      me,\n      userRoles,\n      { User },\n      authlog(resolver, mode, me)\n    );\n\n    assert.isTrue(result);\n  });\n});\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/__tests__/userRoleAuthorized-test.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 86,
    "kind": "variable",
    "name": "assert",
    "memberof": "src/__tests__/userRoleAuthorized-test.js",
    "static": true,
    "longname": "src/__tests__/userRoleAuthorized-test.js~assert",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/userRoleAuthorized-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 6,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 87,
    "kind": "variable",
    "name": "User",
    "memberof": "src/__tests__/userRoleAuthorized-test.js",
    "static": true,
    "longname": "src/__tests__/userRoleAuthorized-test.js~User",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/userRoleAuthorized-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 9,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 88,
    "kind": "variable",
    "name": "resolver",
    "memberof": "src/__tests__/userRoleAuthorized-test.js",
    "static": true,
    "longname": "src/__tests__/userRoleAuthorized-test.js~resolver",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/userRoleAuthorized-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 10,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 89,
    "kind": "variable",
    "name": "mode",
    "memberof": "src/__tests__/userRoleAuthorized-test.js",
    "static": true,
    "longname": "src/__tests__/userRoleAuthorized-test.js~mode",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/__tests__/userRoleAuthorized-test.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 11,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 90,
    "kind": "file",
    "name": "src/generate/index.js",
    "content": "/* eslint-disable max-len */\n/* eslint-disable no-unused-vars */\n\n/* \n * Authorization Code Generator functions\n * \n * @module create-graphql-server-authorization\n * @export function generateAuthCode(typeName, inputSchema)\n *\n */\n\n// name of the @authorize directive, which triggers authorization logic\nconst AUTHORIZE_DIRECTIVE = 'authorize';\n\n// constants to read GraphQL Abstract Syntax Tree (AST)\nconst FIELD_DEFINITION = 'FieldDefinition';\nconst NON_NULL_TYPE = 'NonNullType';\nconst STRING_VALUE = 'StringValue';\nconst LIST_TYPE = 'ListType';\nconst LIST_VALUE = 'ListValue';\nconst DIRECTIVE = 'Directive';\nconst ARGUMENT = 'Argument';\nconst NAME = 'Name';\n\n// valid authorization mode values:\nconst CREATE = 'create';\nconst READ = 'read'; // which means both: 'readOne' and 'readMany'\nconst READ_ONE = 'readOne';\nconst READ_MANY = 'readMany';\nconst UPDATE = 'update';\nconst DELETE = 'delete';\n\n// for the role definitions\nconst USER_ROLE = 'userRole';\nconst DOC_ROLE = 'docRole';\nconst AUTH_ROLE = 'authRole';\nconst FOR = 'for';\nconst THIS = 'this';\nconst NAMED_TYPE = 'NamedType';\nconst STRING = 'String';\nconst LIST_OF_STRINGS = '[String]';\nconst USER = 'User';\nconst LIST_OF_USERS = '[User]';\nconst ID_FIELD = '_id';\nconst ID_SINGULAR = 'Id';\nconst ID_PLURAL = 'Ids';\n\n// valid authorization modes\nconst MODES = [CREATE, READ, READ_ONE, READ_MANY, UPDATE, DELETE];\n\n// template for default allRoles, to prepare one role\nconst CODE_MODES = [CREATE, READ_ONE, READ_MANY, UPDATE, DELETE];\n\n/*\n * generate authorization code\n * @param {string} typeName    \n * @param {object} inputSchema\n * @return {object} generatedCode\n */\nexport function generateAuthorizationCode(typeName = '', inputSchema = {}) {\n  const authorize = isAuthorizeDirectiveDefined(inputSchema);\n  const { userRoles, docRoles, roleFieldName } = getRoles(\n    authorize,\n    inputSchema\n  );\n  return {\n    generateAuthCodeModeReadOne: generateAuthCodeModeReadOne(\n      authorize,\n      typeName,\n      userRoles.readOne,\n      docRoles.readOne\n    ),\n    generateAuthCodeModeReadMany: generateAuthCodeModeReadMany(\n      authorize,\n      typeName,\n      userRoles.readMany,\n      docRoles.readMany\n    ),\n    generateAuthCodeModeCreate: generateAuthCodeModeCreate(\n      authorize,\n      typeName,\n      userRoles.create,\n      docRoles.create,\n      roleFieldName\n    ),\n    generateAuthCodeModeUpdate: generateAuthCodeModeUpdate(\n      authorize,\n      typeName,\n      userRoles.update,\n      docRoles.update,\n      roleFieldName\n    ),\n    generateAuthCodeModeDelete: generateAuthCodeModeDelete(\n      authorize,\n      typeName,\n      userRoles.delete,\n      docRoles.delete\n    ),\n    generateCreatedBy: generateCreatedBy(authorize, typeName),\n    generateUpdatedBy: generateUpdatedBy(authorize, typeName),\n    generateAuthRoleDefinition: generateAuthRoleDefinition(authorize, typeName),\n    generateAuthRoleMethod: generateAuthRoleMethod(\n      authorize,\n      typeName,\n      roleFieldName\n    )\n  };\n}\n\n/*\n * check, if there is a @authorize directive in the header \n * of the type's inputSchema\n * if there is an @authorize directive => true\n * if thers is no @authorize directive => false\n * @param {object} inputSchema\n * @return {boolean} authorized\n */\nexport function isAuthorizeDirectiveDefined(inputSchema) {\n  const authorized =\n    (inputSchema.definitions &&\n      inputSchema.definitions[0] &&\n      inputSchema.definitions[0].directives &&\n      inputSchema.definitions[0].directives[0] &&\n      inputSchema.definitions[0].directives[0].name &&\n      inputSchema.definitions[0].directives[0].name.value ===\n        AUTHORIZE_DIRECTIVE) ||\n    false;\n\n  return authorized;\n}\n\n/*\n * get userRoles and docRoles\n * @param {boolean} authorize\n * @param {object} inputSchema\n * @return {object} {\n *    {object} userRoles,\n *    {object} docRoles,\n *    {string} roleFieldName,\n * }\n */\nfunction getRoles(authorize, inputSchema) {\n  // create empty userRoles and docRoles objects\n  // as default values, which are used\n  // if there is not @authorize directive\n  const userRoles = {};\n  const docRoles = {};\n  const roleFieldNamesFound = [];\n  CODE_MODES.forEach(mode => (userRoles[mode] = []));\n  CODE_MODES.forEach(mode => (docRoles[mode] = []));\n\n  // check if there is an @authorize directive\n  if (authorize) {\n    // then re-determine the userRoles and docRoles\n    // from the @authorize tag of the type definition\n    const allRolesArguments =\n      inputSchema.definitions[0].directives[0].arguments || {};\n    const allRoles = getAllRoles(allRolesArguments, inputSchema);\n    allRoles.forEach(role => {\n      switch (role.type) {\n        case USER_ROLE:\n          // check, if there is already another userRole field\n          if (\n            roleFieldNamesFound.length > 0 &&\n            role.roleFieldName !== '' &&\n            !roleFieldNamesFound.indexOf(role.roleFieldName) >= 0\n          ) {\n            // !roleFieldNamesFound.includes(role.roleFieldName)) {\n\n            // We allow only one field which keeps all userRoles\n            throw new Error(`Please adjust type definition, that there is \n              only ONE field, which keeps all user roles. You've tried to \n              add a second userRole field: '${role.roleFieldName}',\n              but there is already another userRole field: \n              '${roleFieldNamesFound[0]}' defined.\n              Please try instead: '${roleFieldNamesFound[0]}: \n              String @authRole(for: [\"otherRole\", \"${role.roleName}\"])'`);\n          }\n          if (role.roleFieldName !== '') {\n            roleFieldNamesFound.push(role.roleFieldName);\n          }\n\n          Object.keys(role.modes).forEach(mode => {\n            if (role.modes[mode]) {\n              userRoles[mode].push(role.roleName);\n            }\n          });\n          break;\n\n        case DOC_ROLE:\n          Object.keys(role.modes).forEach(mode => {\n            if (role.modes[mode]) {\n              docRoles[mode].push(role.roleName);\n            }\n          });\n          break;\n      }\n    });\n  }\n\n  return {\n    userRoles,\n    docRoles,\n    roleFieldName: roleFieldNamesFound.length > 0 ? roleFieldNamesFound[0] : ''\n  };\n}\n\n/*\n * get the roles from the @authorize directive\n * by reading the input schema's abstract syntax tree\n * to get the roles and their authorized modes\n * @param {object} allRolesArguments\n * @return {array} allRoles\n */\nfunction getAllRoles(allRolesArguments = [], inputSchema) {\n  /*  Example:\n      @authorize(\n      //role:  roleModes: [mode.value]   \n        admin: [\"create\", \"read\", \"update\", \"delete\"]\n        this: [\"read\", \"update\", \"delete\"]\n      ) \n  */\n  const allRoles = [];\n\n  // get all Roles of the type's @authorize directives\n  // e.g. 'admin', 'this'\n  allRolesArguments.forEach(roleArgument => {\n    // new role found\n    const role = {};\n\n    // check if it is a valid role\n    if (\n      roleArgument.kind === ARGUMENT &&\n      roleArgument.name &&\n      roleArgument.name.kind === NAME &&\n      roleArgument.name.value &&\n      roleArgument.name.value !== ''\n    ) {\n      // define the new role\n      role.name = roleArgument.name.value;\n\n      // determine, if it is a 'userRole' or 'docRole'\n      const { roleType, roleName, roleFieldName } = getRoleType(\n        role.name,\n        inputSchema\n      );\n      role.type = roleType;\n      role.roleName = roleName;\n      role.roleFieldName = roleFieldName;\n\n      // create a default object, necessary for missing modes\n      role.modes = {};\n      CODE_MODES.forEach(mode => (role.modes[mode] = ''));\n\n      // check, if it is a list of values\n      if (\n        roleArgument.value.kind &&\n        roleArgument.value.kind === LIST_VALUE &&\n        roleArgument.value.values &&\n        roleArgument.value.values.length > 0\n      ) {\n        // get all authorized modes of the role\n        const roleModes = roleArgument.value.values;\n        roleModes.forEach(mode => {\n          // check, if it is a valid authorization mode\n          // e.g. 'create', 'update', 'delete', etc.\n          if (\n            mode.kind &&\n            mode.kind === STRING_VALUE &&\n            mode.value &&\n            MODES.indexOf(mode.value) >= 0\n          ) {\n            // MODES.includes(mode.value) ){\n\n            // it is a valid authorization mode:\n            // e.g.   {\n            //           name: 'admin',\n            //           type: null,      // later: => 'userRole' || 'docRole'\n            //           modes: {\n            //            create: 'admin',\n            //            readOne: 'admin',\n            //            readMany: 'admin',\n            //            update: 'admin',,\n            //            delete: 'admin',\n            //        }\n            //            'create' = 'admin'\n            // special case 'read' means both, 'readOne' and 'readMany'\n\n            if (mode.value === READ) {\n              role.modes[READ_ONE] = role.roleName;\n              role.modes[READ_MANY] = role.roleName;\n            } else {\n              role.modes[mode.value] = role.roleName;\n            }\n          }\n        });\n\n        // check, if it is a simple string value:\n      } else if (\n        roleArgument.name.value.kind &&\n        roleArgument.name.value.kind === STRING_VALUE &&\n        roleArgument.name.value &&\n        MODES.indexOf(roleArgument.name.value) >= 0\n      ) {\n        // MODES.includes(roleArgument.name.value) ) {\n\n        //                         'create' = 'admin'\n        // special case 'read' means both, 'readOne' and 'readMany'\n        if (roleArgument.name.value === READ) {\n          role.modes[READ_ONE] = role.roleName;\n          role.modes[READ_MANY] = role.roleName;\n        } else {\n          role.modes[roleArgument.name.value] = role.roleName;\n        }\n      }\n      // add it to the list of roles\n      allRoles.push(role);\n    }\n  });\n\n  return allRoles;\n}\n\n/*\n * decide, if the given role is whether \n * a 'userRole' or a 'docRole'\n *\n * Procedure:\n * 1. Determine, if this field is used as a roleField\n * 2. Check, if this roleField...\n *    a) is of type: String or [String] ==> userRole\n *    b) is of type: User or [User]     ==> docRole\n *    c) roleName = 'this'              ==> docRole\n * 3. If there is no roleField in this type\n *    it must be a userRole\n * \n * For 1. is a roleField:\n *   read the type's abstract syntax tree\n *   loop over all provided fields,\n *   check, if the field has a directive '@authRole'\n *   and if this authRole is 'for' the provided 'roleName'\n *   or the roleName is the special case 'this'\n *   ==> then it is a roleField\n *\n * For 2. get it's fieldType:\n *   read the type's abstract syntax tree\n *   for the roleField and read it's type\n *   \n *   a) if it is a String or List of Strings,\n *   then the roleType = 'userRole'\n *\n *   b) if it is a User or List of Users (userIds),\n *   then the roleType = 'docType'\n *\n *   c) special case: roleName = 'this'\n *   (it doesn't look for an authRole for 'this')\n *   it means the document's id field is used for this\n *   meaning the role defines the authorizations,\n *   a User has upon his own User document\n *\n * For 3. none of the above applies\n *   so the role must be a userRole\n *   \n * @param {string} roleName\n * @return {string} roleType => 'userRole' || 'docRole' || exception\n */\nfunction getRoleType(name = '', inputSchema = {}) {\n  // all field definitions of the type\n  const allFields = inputSchema.definitions[0].fields;\n  let roleType = null;\n  let roleName = '';\n  let roleFieldName = '';\n\n  // special case 'this'\n  if (name === THIS) {\n    return {\n      roleType: DOC_ROLE,\n      roleName: ID_FIELD,\n      roleFieldName: ID_FIELD\n    };\n  }\n\n  // loop over all fields to find authRole directive\n  allFields.forEach(field => {\n    if (\n      field.kind &&\n      field.kind === FIELD_DEFINITION &&\n      field.name &&\n      field.name.kind &&\n      field.name.kind === NAME &&\n      field.name.value &&\n      field.directives &&\n      field.directives.length > 0\n    ) {\n      // 1. check, if it is a roleField\n      if (isRoleField(name, field.directives)) {\n        // 2. get the type of the field\n        const fieldType = getFieldType(field);\n        // determine the roleType: 'userRole' || 'docRole'\n        // and the roleName for...\n        // userRoles: 'admin', 'user',...\n        // docRoles: 'authorId', 'coAuthorsIds',...\n        switch (fieldType) {\n          case STRING:\n            // a) userRole\n            roleType = USER_ROLE;\n            roleName = name;\n            roleFieldName = field.name.value;\n            break;\n\n          case LIST_OF_STRINGS:\n            // a) userRole\n            roleType = USER_ROLE;\n            roleName = name;\n            roleFieldName = field.name.value;\n            break;\n\n          case USER:\n            // b) docRole\n            roleType = DOC_ROLE;\n            roleName = `${field.name.value}${ID_SINGULAR}`;\n            roleFieldName = field.name.value;\n            break;\n\n          case LIST_OF_USERS:\n            // b) docRole\n            roleType = DOC_ROLE;\n            roleName = `${field.name.value}${ID_PLURAL}`;\n            roleFieldName = field.name.value;\n            break;\n        }\n      }\n    }\n  });\n\n  if (roleType) {\n    // 2. a) userRole or b) docRole applies\n    return {\n      roleType,\n      roleName,\n      roleFieldName\n    };\n  } else if (name !== '') {\n    // 3. none of the above applies, so it must be a userRole\n    return {\n      roleType: USER_ROLE,\n      roleName: name,\n      roleFieldName: ''\n    };\n  }\n}\n\n/*\n * is this field a roleField\n * check, if this field has the authRole directive\n * @param {string} roleName\n * @param {array} fieldDirectives \n * @return {boolean} isRoleField\n */\nfunction isRoleField(roleName, fieldDirectives) {\n  let found = false;\n\n  // loop over all field directives for an 'authRole'\n  fieldDirectives.forEach(fieldDirective => {\n    if (\n      fieldDirective.kind &&\n      fieldDirective.kind === DIRECTIVE &&\n      fieldDirective.name &&\n      fieldDirective.name.kind === NAME &&\n      fieldDirective.name.value === AUTH_ROLE &&\n      fieldDirective.arguments &&\n      fieldDirective.arguments.length > 0\n    ) {\n      // loop over all arguments, if it is for our roleName\n      // e.g. roleName: 'admin' find @authRole(for: [\"admin\"])\n      fieldDirective.arguments.forEach(fieldDirectiveArgument => {\n        // check, if there is a 'for'\n        if (\n          fieldDirectiveArgument.name &&\n          fieldDirectiveArgument.name.kind &&\n          fieldDirectiveArgument.name.kind === NAME &&\n          fieldDirectiveArgument.name.value &&\n          fieldDirectiveArgument.name.value === FOR &&\n          fieldDirectiveArgument.value &&\n          fieldDirectiveArgument.value.kind\n        ) {\n          // check, if it is a list value:\n          if (\n            fieldDirectiveArgument.value.kind === LIST_VALUE &&\n            fieldDirectiveArgument.value.values &&\n            fieldDirectiveArgument.value.values.length > 0\n          ) {\n            // loop over all values, if there is one with our roleName\n            const fieldRoles = fieldDirectiveArgument.value.values;\n            fieldRoles.forEach(fieldRole => {\n              // check, if it is our roleName\n              if (\n                fieldRole.kind &&\n                fieldRole.kind === STRING_VALUE &&\n                fieldRole.value &&\n                fieldRole.value !== '' &&\n                fieldRole.value === roleName\n              ) {\n                // we found it!\n                found = true;\n              }\n            });\n            // check, if it is a single value:\n          } else if (\n            fieldDirectiveArgument.value.kind === STRING_VALUE &&\n            fieldDirectiveArgument.value.value &&\n            fieldDirectiveArgument.value.value !== '' &&\n            fieldDirectiveArgument.value.value === roleName\n          ) {\n            // we found it!\n            found = true;\n          }\n        }\n      });\n    }\n  });\n  return found;\n}\n\n/*\n * get the field's type \n * @param {object} field\n * @return {type} fieldType\n */\nfunction getFieldType(field) {\n  // pattern: 'role: String'\n  if (\n    field.type &&\n    field.type.kind &&\n    field.type.kind === NAMED_TYPE &&\n    field.type.name &&\n    field.type.name.kind &&\n    field.type.name.kind === NAME &&\n    field.type.name.value\n  ) {\n    if (field.type.name.value === STRING) {\n      return STRING;\n    }\n\n    if (field.type.name.value === USER) {\n      return USER;\n    }\n  }\n\n  // pattern: 'role: String!'\n  if (\n    field.type &&\n    field.type.kind &&\n    field.type.kind === NON_NULL_TYPE &&\n    field.type.type &&\n    field.type.type.name &&\n    field.type.type.name.kind &&\n    field.type.type.name.kind === NAME &&\n    field.type.type.name.value\n  ) {\n    if (field.type.type.name.value === STRING) {\n      return STRING;\n    }\n\n    if (field.type.type.name.value === USER) {\n      return USER;\n    }\n  }\n\n  // pattern: 'coauthors: [User]'\n  if (\n    field.type &&\n    field.type.kind &&\n    field.type.kind === LIST_TYPE &&\n    field.type.type &&\n    field.type.type.name &&\n    field.type.type.name.kind &&\n    field.type.type.name.kind === NAME &&\n    field.type.type.name.value\n  ) {\n    if (field.type.type.name.value === STRING) {\n      return LIST_OF_STRINGS;\n    }\n\n    if (field.type.type.name.value === USER) {\n      return LIST_OF_USERS;\n    }\n  }\n\n  // pattern: 'coauthors: [User]!'\n  if (\n    field.type &&\n    field.type.kind &&\n    field.type.kind === NON_NULL_TYPE &&\n    field.type.type &&\n    field.type.type.kind &&\n    field.type.type.kind === LIST_TYPE &&\n    field.type.type.type &&\n    field.type.type.type.kind &&\n    field.type.type.type.kind === NAMED_TYPE &&\n    field.type.type.type.name &&\n    field.type.type.type.name.kind &&\n    field.type.type.type.name.kind === NAME &&\n    field.type.type.type.name.value\n  ) {\n    if (field.type.type.type.name.value === STRING) {\n      return LIST_OF_STRINGS;\n    }\n\n    if (field.type.type.type.name.value === USER) {\n      return LIST_OF_USERS;\n    }\n  }\n\n  // pattern: 'coauthors: [User!]'\n  if (\n    field.type &&\n    field.type.kind &&\n    field.type.kind === LIST_TYPE &&\n    field.type.type &&\n    field.type.type.kind &&\n    field.type.type.kind === NON_NULL_TYPE &&\n    field.type.type.type &&\n    field.type.type.type.kind &&\n    field.type.type.type.kind === NAMED_TYPE &&\n    field.type.type.type.name &&\n    field.type.type.type.name.kind &&\n    field.type.type.type.name.kind === NAME &&\n    field.type.type.type.name.value\n  ) {\n    if (field.type.type.type.name.value === STRING) {\n      return LIST_OF_STRINGS;\n    }\n\n    if (field.type.type.type.name.value === USER) {\n      return LIST_OF_USERS;\n    }\n  }\n\n  // pattern: 'coauthors: [User!]!'\n  if (\n    field.type &&\n    field.type.kind &&\n    field.type.kind === NON_NULL_TYPE &&\n    field.type.type &&\n    field.type.type.kind &&\n    field.type.type.kind === LIST_TYPE &&\n    field.type.type.type &&\n    field.type.type.type.kind &&\n    field.type.type.type.kind === NON_NULL_TYPE &&\n    field.type.type.type.type &&\n    field.type.type.type.type.kind &&\n    field.type.type.type.type.kind === NAMED_TYPE &&\n    field.type.type.type.type.name &&\n    field.type.type.type.type.name.kind &&\n    field.type.type.type.type.name.kind === NAME &&\n    field.type.type.type.type.name.value\n  ) {\n    if (field.type.type.type.type.name.value === STRING) {\n      return LIST_OF_STRINGS;\n    }\n\n    if (field.type.type.type.type.name.value === USER) {\n      return LIST_OF_USERS;\n    }\n  }\n\n  return null;\n}\n\n/*\n * prepare roles for code generator\n * convert array to String value\n * replace \" by '\n * @param {array} role\n * @return {string} roleString\n */\nfunction prep(role) {\n  return JSON.stringify(role).replace(/\"/g, \"'\");\n}\n\n/*\n * generate authorization code for mode readOne\n * @param {boolean} authorize\n * @param {string} typeName\n * @param {string} userRoles\n * @param {string} docRoles\n * @return {string} generatedCode\n */\nfunction generateAuthCodeModeReadOne(\n  authorize = false,\n  typeName = '',\n  userRoles = [],\n  docRoles = []\n) {\n  // default code\n  let generatedCode = `const { me } = context;\n    that.authorizedLoader = new DataLoader(ids => findByIds(this.collection, ids))`;\n\n  // with @authorize directive\n  if (authorize) {\n    if (typeName === 'user') {\n      // User has to come from current class context\n      generatedCode = `const { me } = context;\n      const authQuery = queryForRoles(me, ${prep(userRoles)}, ${prep(\n        docRoles\n      )}, { User }, authlog('${typeName} findOneById', 'readOne', me));\n      that.authorizedLoader = new DataLoader(ids => findByIds(this.collection, ids, authQuery));`;\n    } else {\n      // User has to come from this.context.User\n      generatedCode = `const { me, User } = context;\n      const authQuery = queryForRoles(me, ${prep(userRoles)}, ${prep(\n        docRoles\n      )}, { User }, authlog('${typeName} findOneById', 'readOne', me));\n      that.authorizedLoader = new DataLoader(ids => findByIds(this.collection, ids, authQuery));`;\n    }\n  }\n\n  return generatedCode;\n}\n\n/*\n * generate authorization code for mode readMany\n * @param {boolean} authorize\n * @param {string} typeName\n * @param {string} userRoles\n * @param {string} docRoles\n * @return {string} generatedCode\n */\nfunction generateAuthCodeModeReadMany(\n  authorize = false,\n  typeName = '',\n  userRoles = [],\n  docRoles = []\n) {\n  // default code\n  let generatedCode = `const finalQuery = {...baseQuery, createdAt: { $gt: lastCreatedAt } };`;\n\n  // with @authorize directive\n  if (authorize) {\n    generatedCode = `const authQuery = queryForRoles(me, ${prep(\n      userRoles\n    )}, ${prep(\n      docRoles\n    )}, { User: this.context.User }, authlog(resolver, 'readMany', me));\n      const finalQuery = {...baseQuery, ...authQuery, createdAt: { $gt: lastCreatedAt } };`;\n  }\n\n  return generatedCode;\n}\n\n/*\n * generate authorization code for mode create\n * @param {boolean} authorize\n * @param {string} typeName\n * @param {string} userRoles\n * @param {string} docRoles\n * @return {string} generatedCode\n */\nfunction generateAuthCodeModeCreate(\n  authorize = false,\n  typeName = '',\n  userRoles = [],\n  docRoles = [],\n  roleFieldName = null\n) {\n  // default code\n  let generatedCode = ``;\n\n  // with @authorize directive\n  if (authorize) {\n    if (typeName === 'user') {\n      // protectFields only on the user type\n      // if the fields are filled, than convert them to proper strings,\n      // otherwise set them to null\n      // take the first userRole into the protectFields as a suggestion\n      // to the programmer, assuming this is the most important role,\n      // with higher authorization (see in README.md)\n      const firstUserRole =\n        userRoles.length > 0 && userRoles[0] ? `'${userRoles[0]}'` : null;\n      const roleField = roleFieldName ? `'${roleFieldName}'` : null;\n      generatedCode = `checkAuthDoc(docToInsert, me, ${prep(userRoles)}, ${prep(\n        docRoles\n      )}, { User: this.context.User }, authlog(resolver, 'create', me));\n      docToInsert = protectFields(me, [${firstUserRole}], [${roleField}], docToInsert, { User: this.context.User });`;\n    } else {\n      // without protectFields\n      generatedCode = `checkAuthDoc(docToInsert, me, ${prep(userRoles)}, ${prep(\n        docRoles\n      )}, { User: this.context.User }, authlog(resolver, 'create', me));`;\n    }\n  }\n\n  return generatedCode;\n}\n\n/*\n * generate authorization code for mode update\n * @param {boolean} authorize\n * @param {string} typeName\n * @param {string} userRoles\n * @param {string} docRoles\n * @return {string} generatedCode\n */\nfunction generateAuthCodeModeUpdate(\n  authorize = false,\n  typeName = '',\n  userRoles = [],\n  docRoles = [],\n  roleFieldName = null\n) {\n  // default code\n  let generatedCode = `const finalQuery = {...baseQuery};`;\n\n  // with @authorize directive\n  if (authorize) {\n    if (typeName === 'user') {\n      // protectFields only on the user type\n      // if the fields are filled, than convert them to proper strings,\n      // otherwise set them to null\n      // take the first userRole into the protectFields\n      // as a suggestion to the programmer,\n      // assuming this is the most important role,\n      // with higher authorization (see in README.md)\n      const firstUserRole =\n        userRoles.length > 0 && userRoles[0] ? `'${userRoles[0]}'` : null;\n      const roleField = roleFieldName ? `'${roleFieldName}'` : null;\n      generatedCode = `const authQuery = queryForRoles(me, ${prep(\n        userRoles\n      )}, ${prep(\n        docRoles\n      )}, { User: this.context.User }, authlog(resolver, 'update', me));\n      const finalQuery = {...baseQuery, ...authQuery};\n      docToUpdate.$set = protectFields(me, [${firstUserRole}], [${roleField}], docToUpdate.$set, { User: this.context.User });`;\n    } else {\n      // without protectFields\n      generatedCode = `const authQuery = queryForRoles(me, ${prep(\n        userRoles\n      )}, ${prep(\n        docRoles\n      )}, { User: this.context.User }, authlog(resolver, 'update', me));\n      const finalQuery = {...baseQuery, ...authQuery};`;\n    }\n  }\n\n  return generatedCode;\n}\n\n/*\n * generate authorization code for mode delete\n * @param {boolean} authorize\n * @param {string} typeName\n * @param {string} userRoles\n * @param {string} docRoles\n * @return {string} generatedCode\n */\nfunction generateAuthCodeModeDelete(\n  authorize = false,\n  typeName = '',\n  userRoles = [],\n  docRoles = []\n) {\n  // default code\n  let generatedCode = `const finalQuery = {...baseQuery};`;\n\n  // with @authorize directive\n  if (authorize) {\n    generatedCode = `const authQuery = queryForRoles(me, ${prep(\n      userRoles\n    )}, ${prep(\n      docRoles\n    )}, { User: this.context.User }, authlog(resolver, 'delete', me));\n      const finalQuery = {...baseQuery, ...authQuery};`;\n  }\n\n  return generatedCode;\n}\n\n/*\n * generate createdBy method\n * @param {boolean} authorize\n * @param {string} typeName\n * @return {string} generatedCode\n */\nfunction generateCreatedBy(authorize = false, typeName = '') {\n  // default code\n  let generatedCode = ``;\n\n  // with @authorize directive: means there must be a User type\n  if (authorize) {\n    generatedCode = `createdBy(${typeName}, me, resolver) {\n    return this.context.User.findOneById(${typeName}.createdById, me, resolver);\n  }`;\n  }\n\n  return generatedCode;\n}\n\n/*\n * generate updatedBy method\n * @param {boolean} authorize\n * @param {string} typeName\n * @return {string} generatedCode\n */\nfunction generateUpdatedBy(authorize = false, typeName = '') {\n  // default code\n  let generatedCode = ``;\n\n  // with @authorize directive: means there must be a User type\n  if (authorize) {\n    generatedCode = `updatedBy(${typeName}, me, resolver) {\n    return this.context.User.findOneById(${typeName}.updatedById, me, resolver);\n  }`;\n  }\n\n  return generatedCode;\n}\n\n/*\n * generate updatedBy method\n * @param {boolean} authorize\n * @param {string} typeName\n * @return {string} generatedCode\n */\nfunction generateAuthRoleDefinition(authorize, typeName) {\n  // default code\n  let generatedCode = ``;\n\n  // with @authorize directive: means there must be a User type\n  if (authorize && typeName === 'user') {\n    generatedCode = `\n    this.authRole = User.authRole;`;\n  }\n\n  return generatedCode;\n}\n\n/*\n * generate authRole() method\n * @param {boolean} authorize\n * @param {string} typeName\n * @return {string} generatedCode\n */\nfunction generateAuthRoleMethod(authorize, typeName, roleFieldName) {\n  // default code\n  let generatedCode = ``;\n\n  // with @authorize directive: means there must be a User type\n  if (authorize && roleFieldName !== '' && typeName === 'user') {\n    generatedCode = `\n  static authRole(${typeName}){\n    return (${typeName} && ${typeName}.${roleFieldName}) ? ${typeName}.${roleFieldName} : null;\n  }\n  `;\n  }\n\n  return generatedCode;\n}\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/generate/index.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 91,
    "kind": "variable",
    "name": "AUTHORIZE_DIRECTIVE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~AUTHORIZE_DIRECTIVE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 13,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 92,
    "kind": "variable",
    "name": "FIELD_DEFINITION",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~FIELD_DEFINITION",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 16,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 93,
    "kind": "variable",
    "name": "NON_NULL_TYPE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~NON_NULL_TYPE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 17,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 94,
    "kind": "variable",
    "name": "STRING_VALUE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~STRING_VALUE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 18,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 95,
    "kind": "variable",
    "name": "LIST_TYPE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~LIST_TYPE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 19,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 96,
    "kind": "variable",
    "name": "LIST_VALUE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~LIST_VALUE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 20,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 97,
    "kind": "variable",
    "name": "DIRECTIVE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~DIRECTIVE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 21,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 98,
    "kind": "variable",
    "name": "ARGUMENT",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~ARGUMENT",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 22,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 99,
    "kind": "variable",
    "name": "NAME",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~NAME",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 23,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 100,
    "kind": "variable",
    "name": "CREATE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~CREATE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 26,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 101,
    "kind": "variable",
    "name": "READ",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~READ",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 102,
    "kind": "variable",
    "name": "READ_ONE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~READ_ONE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 28,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 103,
    "kind": "variable",
    "name": "READ_MANY",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~READ_MANY",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 29,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 104,
    "kind": "variable",
    "name": "UPDATE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~UPDATE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 30,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 105,
    "kind": "variable",
    "name": "DELETE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~DELETE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 31,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 106,
    "kind": "variable",
    "name": "USER_ROLE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~USER_ROLE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 34,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 107,
    "kind": "variable",
    "name": "DOC_ROLE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~DOC_ROLE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 35,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 108,
    "kind": "variable",
    "name": "AUTH_ROLE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~AUTH_ROLE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 36,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 109,
    "kind": "variable",
    "name": "FOR",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~FOR",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 37,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 110,
    "kind": "variable",
    "name": "THIS",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~THIS",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 38,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 111,
    "kind": "variable",
    "name": "NAMED_TYPE",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~NAMED_TYPE",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 39,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 112,
    "kind": "variable",
    "name": "STRING",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~STRING",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 40,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 113,
    "kind": "variable",
    "name": "LIST_OF_STRINGS",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~LIST_OF_STRINGS",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 41,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 114,
    "kind": "variable",
    "name": "USER",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~USER",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 42,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 115,
    "kind": "variable",
    "name": "LIST_OF_USERS",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~LIST_OF_USERS",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 43,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 116,
    "kind": "variable",
    "name": "ID_FIELD",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~ID_FIELD",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 44,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 117,
    "kind": "variable",
    "name": "ID_SINGULAR",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~ID_SINGULAR",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 45,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 118,
    "kind": "variable",
    "name": "ID_PLURAL",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~ID_PLURAL",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 46,
    "undocument": true,
    "type": {
      "types": [
        "string"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 119,
    "kind": "variable",
    "name": "MODES",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~MODES",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 49,
    "undocument": true,
    "type": {
      "types": [
        "undefined[]"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 120,
    "kind": "variable",
    "name": "CODE_MODES",
    "memberof": "src/generate/index.js",
    "static": true,
    "longname": "src/generate/index.js~CODE_MODES",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 52,
    "undocument": true,
    "type": {
      "types": [
        "undefined[]"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 121,
    "kind": "function",
    "name": "generateAuthorizationCode",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~generateAuthorizationCode",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": "{generateAuthorizationCode}",
    "description": null,
    "lineNumber": 60,
    "undocument": true,
    "params": [
      {
        "name": "typeName",
        "optional": true,
        "types": [
          "string"
        ],
        "defaultRaw": "",
        "defaultValue": ""
      },
      {
        "name": "inputSchema",
        "optional": true,
        "types": [
          "{}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      }
    ],
    "return": {
      "types": [
        "{\"generateAuthCodeModeReadOne\": *, \"generateAuthCodeModeReadMany\": *, \"generateAuthCodeModeCreate\": *, \"generateAuthCodeModeUpdate\": *, \"generateAuthCodeModeDelete\": *, \"generateCreatedBy\": *, \"generateUpdatedBy\": *, \"generateAuthRoleDefinition\": *, \"generateAuthRoleMethod\": *}"
      ]
    }
  },
  {
    "__docId__": 122,
    "kind": "function",
    "name": "isAuthorizeDirectiveDefined",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~isAuthorizeDirectiveDefined",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": "{isAuthorizeDirectiveDefined}",
    "description": null,
    "lineNumber": 118,
    "undocument": true,
    "params": [
      {
        "name": "inputSchema",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 123,
    "kind": "function",
    "name": "getRoles",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~getRoles",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 142,
    "undocument": true,
    "params": [
      {
        "name": "authorize",
        "types": [
          "*"
        ]
      },
      {
        "name": "inputSchema",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "{\"userRoles\": *, \"docRoles\": *, \"roleFieldName\": *}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 124,
    "kind": "function",
    "name": "getAllRoles",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~getAllRoles",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 215,
    "undocument": true,
    "params": [
      {
        "name": "allRolesArguments",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "inputSchema",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 125,
    "kind": "function",
    "name": "getRoleType",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~getRoleType",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 367,
    "undocument": true,
    "params": [
      {
        "name": "name",
        "optional": true,
        "types": [
          "string"
        ],
        "defaultRaw": "",
        "defaultValue": ""
      },
      {
        "name": "inputSchema",
        "optional": true,
        "types": [
          "{}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      }
    ],
    "return": {
      "types": [
        "{\"roleType\": *, \"roleName\": *, \"roleFieldName\": *}"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 126,
    "kind": "function",
    "name": "isRoleField",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~isRoleField",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 460,
    "undocument": true,
    "params": [
      {
        "name": "roleName",
        "types": [
          "*"
        ]
      },
      {
        "name": "fieldDirectives",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 127,
    "kind": "function",
    "name": "getFieldType",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~getFieldType",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 530,
    "undocument": true,
    "params": [
      {
        "name": "field",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 128,
    "kind": "function",
    "name": "prep",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~prep",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 678,
    "undocument": true,
    "params": [
      {
        "name": "role",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 129,
    "kind": "function",
    "name": "generateAuthCodeModeReadOne",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~generateAuthCodeModeReadOne",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 690,
    "undocument": true,
    "params": [
      {
        "name": "authorize",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": false,
        "defaultValue": "false"
      },
      {
        "name": "typeName",
        "optional": true,
        "types": [
          "string"
        ],
        "defaultRaw": "",
        "defaultValue": ""
      },
      {
        "name": "userRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "docRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 130,
    "kind": "function",
    "name": "generateAuthCodeModeReadMany",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~generateAuthCodeModeReadMany",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 730,
    "undocument": true,
    "params": [
      {
        "name": "authorize",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": false,
        "defaultValue": "false"
      },
      {
        "name": "typeName",
        "optional": true,
        "types": [
          "string"
        ],
        "defaultRaw": "",
        "defaultValue": ""
      },
      {
        "name": "userRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "docRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 131,
    "kind": "function",
    "name": "generateAuthCodeModeCreate",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~generateAuthCodeModeCreate",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 760,
    "undocument": true,
    "params": [
      {
        "name": "authorize",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": false,
        "defaultValue": "false"
      },
      {
        "name": "typeName",
        "optional": true,
        "types": [
          "string"
        ],
        "defaultRaw": "",
        "defaultValue": ""
      },
      {
        "name": "userRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "docRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "roleFieldName",
        "optional": true,
        "types": [
          "undefined"
        ],
        "defaultValue": "undefined"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 132,
    "kind": "function",
    "name": "generateAuthCodeModeUpdate",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~generateAuthCodeModeUpdate",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 805,
    "undocument": true,
    "params": [
      {
        "name": "authorize",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": false,
        "defaultValue": "false"
      },
      {
        "name": "typeName",
        "optional": true,
        "types": [
          "string"
        ],
        "defaultRaw": "",
        "defaultValue": ""
      },
      {
        "name": "userRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "docRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "roleFieldName",
        "optional": true,
        "types": [
          "undefined"
        ],
        "defaultValue": "undefined"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 133,
    "kind": "function",
    "name": "generateAuthCodeModeDelete",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~generateAuthCodeModeDelete",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 857,
    "undocument": true,
    "params": [
      {
        "name": "authorize",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": false,
        "defaultValue": "false"
      },
      {
        "name": "typeName",
        "optional": true,
        "types": [
          "string"
        ],
        "defaultRaw": "",
        "defaultValue": ""
      },
      {
        "name": "userRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "docRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 134,
    "kind": "function",
    "name": "generateCreatedBy",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~generateCreatedBy",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 885,
    "undocument": true,
    "params": [
      {
        "name": "authorize",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": false,
        "defaultValue": "false"
      },
      {
        "name": "typeName",
        "optional": true,
        "types": [
          "string"
        ],
        "defaultRaw": "",
        "defaultValue": ""
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 135,
    "kind": "function",
    "name": "generateUpdatedBy",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~generateUpdatedBy",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 905,
    "undocument": true,
    "params": [
      {
        "name": "authorize",
        "optional": true,
        "types": [
          "boolean"
        ],
        "defaultRaw": false,
        "defaultValue": "false"
      },
      {
        "name": "typeName",
        "optional": true,
        "types": [
          "string"
        ],
        "defaultRaw": "",
        "defaultValue": ""
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 136,
    "kind": "function",
    "name": "generateAuthRoleDefinition",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~generateAuthRoleDefinition",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 925,
    "undocument": true,
    "params": [
      {
        "name": "authorize",
        "types": [
          "*"
        ]
      },
      {
        "name": "typeName",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 137,
    "kind": "function",
    "name": "generateAuthRoleMethod",
    "memberof": "src/generate/index.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/generate/index.js~generateAuthRoleMethod",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/generate/index.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 944,
    "undocument": true,
    "params": [
      {
        "name": "authorize",
        "types": [
          "*"
        ]
      },
      {
        "name": "typeName",
        "types": [
          "*"
        ]
      },
      {
        "name": "roleFieldName",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 138,
    "kind": "file",
    "name": "src/index.js",
    "content": "/*\n * '../index.js' file provides access to all public \n * create graphql server \n * authorization functions\n */\n\n/* for the model authorization logic */\nexport { getLogFilename } from './lib/getLogFilename.js';\nexport { dummyUserContext } from './lib/dummyUserContext.js';\nexport { logger } from './lib/logger.js';\nexport { authlog } from './lib/authlog.js';\nexport { checkAuthDoc } from './lib/checkAuthDoc.js';\nexport { fieldContainsUserId } from './lib/fieldContainsUserId.js';\nexport { findByIds } from './lib/findByIds.js';\nexport { loggedIn } from './lib/loggedIn.js';\nexport { protectFields } from './lib/protectFields.js';\nexport { queryForRoles } from './lib/queryForRoles.js';\nexport { userRoleAuthorized } from './lib/userRoleAuthorized.js';\n\n/* for the code generator */\nexport {\n  generateAuthorizationCode,\n  isAuthorizeDirectiveDefined\n} from './generate/index.js';\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/index.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 139,
    "kind": "file",
    "name": "src/lib/authlog.js",
    "content": "import { logger } from './logger';\nimport { getLogFilename } from './getLogFilename';\n\n/*\n * Central logger for authorization checks\n * @param {string} resolver\n * @param {string} mode\n * @param {object} me\n * @return {\n *    debug {function},\n *    error {function} \n * }\n */\nexport function authlog(resolver = '', mode = '', me = {}) {\n  const logFilename = getLogFilename();\n  const log = logger(logFilename);\n\n  const makeMessage = message =>\n    `Authorize ${mode} '${resolver}' with user '${me.username\n      ? me.username\n      : '<no-user>'}' ${message}`;\n\n  return {\n    debug: message => {\n      const resultMessage = makeMessage(message);\n      log.debug(resultMessage);\n      return resultMessage;\n    },\n    error: message => {\n      const resultMessage = makeMessage(message);\n      log.error(resultMessage);\n      throw new Error(makeMessage(message));\n    }\n  };\n}\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/lib/authlog.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 140,
    "kind": "function",
    "name": "authlog",
    "memberof": "src/lib/authlog.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/authlog.js~authlog",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/lib/authlog.js",
    "importStyle": "{authlog}",
    "description": null,
    "lineNumber": 14,
    "undocument": true,
    "params": [
      {
        "name": "resolver",
        "optional": true,
        "types": [
          "string"
        ],
        "defaultRaw": "",
        "defaultValue": ""
      },
      {
        "name": "mode",
        "optional": true,
        "types": [
          "string"
        ],
        "defaultRaw": "",
        "defaultValue": ""
      },
      {
        "name": "me",
        "optional": true,
        "types": [
          "{}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      }
    ],
    "return": {
      "types": [
        "{\"debug\": *, \"error\": *}"
      ]
    }
  },
  {
    "__docId__": 141,
    "kind": "file",
    "name": "src/lib/checkAuthDoc.js",
    "content": "import { userRoleAuthorized } from './userRoleAuthorized';\nimport { fieldContainsUserId } from './fieldContainsUserId';\nimport { authlog } from './authlog';\n\nconst defaultLogger = authlog();\n\n/*\n * Returns an authorized document\n * @param {object} doc\n * @param {object} me\n * @param {array} userRoles\n * @param {array} docRoles\n * @param {object} User\n * @param {function} logger\n * @return {object} doc\n */\n\nexport function checkAuthDoc(\n  doc = {},\n  me = {},\n  userRoles = [],\n  docRoles = [],\n  { User },\n  logger = defaultLogger\n) {\n  const resultDoc = Object.assign({}, doc);\n\n  // get the User's role\n  const role = User.authRole(me);\n\n  // check if userRole entitles current user for this action\n  if (userRoleAuthorized(me, userRoles, { User }, logger)) {\n    logger.debug(`and role: '${role}' is authorized by userRole.`);\n    return resultDoc;\n  }\n\n  // check if docRole entitles current user for this document and action\n  let authorized = false;\n  docRoles.every(field => {\n    if (\n      resultDoc[field] &&\n      me._id &&\n      fieldContainsUserId(resultDoc[field], me._id)\n    ) {\n      authorized = true;\n    }\n  });\n  if (authorized) {\n    logger.debug(`and role: '${role}' is authorized by docRole.`);\n    return resultDoc;\n  }\n\n  // Not Authorized, throw exception in logger.error\n  logger.error(`and role: '${role}' is not authorized.`);\n}\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/lib/checkAuthDoc.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 142,
    "kind": "variable",
    "name": "defaultLogger",
    "memberof": "src/lib/checkAuthDoc.js",
    "static": true,
    "longname": "src/lib/checkAuthDoc.js~defaultLogger",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/lib/checkAuthDoc.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 5,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 143,
    "kind": "function",
    "name": "checkAuthDoc",
    "memberof": "src/lib/checkAuthDoc.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/checkAuthDoc.js~checkAuthDoc",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/lib/checkAuthDoc.js",
    "importStyle": "{checkAuthDoc}",
    "description": null,
    "lineNumber": 18,
    "undocument": true,
    "params": [
      {
        "name": "doc",
        "optional": true,
        "types": [
          "{}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      },
      {
        "name": "me",
        "optional": true,
        "types": [
          "{}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      },
      {
        "name": "userRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "docRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "objectPattern4",
        "types": [
          "{\"User\": *}"
        ],
        "defaultRaw": {
          "User": null
        },
        "defaultValue": "{\"User\":null}"
      },
      {
        "name": "logger",
        "optional": true,
        "types": [
          "*"
        ],
        "defaultRaw": "defaultLogger",
        "defaultValue": "defaultLogger"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 144,
    "kind": "file",
    "name": "src/lib/dummyUserContext.js",
    "content": "/*\n * Returns a dummyUserContext\n * mocking User authRole, as it is not existing in this library\n * for usage in the test cases, where we don't have an original \n * User model context\n * @return {object} dummyUserContext\n */\nexport const dummyUserContext = {\n  authRole(user) {\n    return user && user.role ? user.role : null;\n  }\n};\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/lib/dummyUserContext.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 145,
    "kind": "variable",
    "name": "dummyUserContext",
    "memberof": "src/lib/dummyUserContext.js",
    "static": true,
    "longname": "src/lib/dummyUserContext.js~dummyUserContext",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/lib/dummyUserContext.js",
    "importStyle": "{dummyUserContext}",
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "type": {
      "types": [
        "{\"authRole\": function}"
      ]
    }
  },
  {
    "__docId__": 146,
    "kind": "file",
    "name": "src/lib/fieldContainsUserId.js",
    "content": "import _ from 'lodash';\n\n/*\n * extract a UserId from a _id object\n * @param {object} userIdObject\n * @return {string} newUserId\n */\nfunction extractUserId(userIdObject) {\n  let newUserId = '';\n  if (_.isObject(userIdObject)) {\n    Object.keys(userIdObject).forEach(field => {\n      newUserId = userIdObject[field];\n    });\n  } else {\n    newUserId = userIdObject;\n  }\n  return newUserId;\n}\n\n/*\n * checks, if a field contains a user's id\n * returns true, if a field of type array/object/string contains the userId\n * @param {string, object, array} docRoleField\n * @param {string, object} userId\n * @return {boolean} foundUserId\n */\nexport function fieldContainsUserId(docRoleField, compressedUserId) {\n  let found = false;\n\n  // empty docRoleField is not a valid docRoleField\n  if (!docRoleField || docRoleField === '' || docRoleField.length === 0) {\n    return false;\n  }\n\n  // empty (compressed) userId is not a valid userId\n  if (\n    !compressedUserId ||\n    compressedUserId === '' ||\n    compressedUserId.toString() === ''\n  ) {\n    return false;\n  }\n\n  // extract userId, if it is a mongoID field\n  const userId = extractUserId(compressedUserId);\n\n  // empty (uncompressed) userId is not a valid userId\n  if (!userId || userId === '') {\n    return false;\n  }\n\n  // docRoleField of type Array\n  if (_.isArray(docRoleField)) {\n    docRoleField.forEach(field => {\n      if (fieldContainsUserId(field, userId)) {\n        found = true;\n      }\n    });\n    if (found) {\n      return true;\n    }\n    return false;\n  }\n\n  // docRoleField of type Object\n  if (_.isObject(docRoleField)) {\n    // For each field in the object\n    Object.keys(docRoleField).forEach(field => {\n      if (\n        fieldContainsUserId(docRoleField[field], userId) ||\n        fieldContainsUserId(field, userId)\n      ) {\n        found = true;\n      }\n    });\n    if (found) {\n      return true;\n    }\n    return false;\n  }\n\n  // docRoleField of type field\n  if (docRoleField.toString() === userId.toString()) {\n    return true;\n  }\n\n  return false;\n}\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/lib/fieldContainsUserId.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 147,
    "kind": "function",
    "name": "extractUserId",
    "memberof": "src/lib/fieldContainsUserId.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/fieldContainsUserId.js~extractUserId",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/lib/fieldContainsUserId.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 8,
    "undocument": true,
    "params": [
      {
        "name": "userIdObject",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 148,
    "kind": "function",
    "name": "fieldContainsUserId",
    "memberof": "src/lib/fieldContainsUserId.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/fieldContainsUserId.js~fieldContainsUserId",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/lib/fieldContainsUserId.js",
    "importStyle": "{fieldContainsUserId}",
    "description": null,
    "lineNumber": 27,
    "undocument": true,
    "params": [
      {
        "name": "docRoleField",
        "types": [
          "*"
        ]
      },
      {
        "name": "compressedUserId",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 149,
    "kind": "file",
    "name": "src/lib/getLogFilename.js",
    "content": "import path from 'path';\n\nconst expect = require('chai').expect;\n\n/* Get log filename\n * package.json should be existing in current working directory\n * and should have a section 'config' with a 'logfile' name\n * @return (string) logFilename\n */\nexport function getLogFilename() {\n  const packageJSON = require(`${process.cwd()}/package.json`);\n  const logFilename = path.normalize(packageJSON.config.logfile);\n  expect(logFilename).be.a('string');\n  return logFilename;\n}\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/lib/getLogFilename.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 150,
    "kind": "variable",
    "name": "expect",
    "memberof": "src/lib/getLogFilename.js",
    "static": true,
    "longname": "src/lib/getLogFilename.js~expect",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/lib/getLogFilename.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 3,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 151,
    "kind": "function",
    "name": "getLogFilename",
    "memberof": "src/lib/getLogFilename.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/getLogFilename.js~getLogFilename",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/lib/getLogFilename.js",
    "importStyle": "{getLogFilename}",
    "description": null,
    "lineNumber": 10,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 152,
    "kind": "file",
    "name": "src/lib/loggedIn.js",
    "content": "/*\n * Checks if an user is logged in\n * @param {object} me\n * @return {boolean} loggedIn\n */\n\nexport function loggedIn(me) {\n  if (me && me._id && me._id.toString() !== '') {\n    return true;\n  }\n  return false;\n}\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/lib/loggedIn.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 153,
    "kind": "function",
    "name": "loggedIn",
    "memberof": "src/lib/loggedIn.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/loggedIn.js~loggedIn",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/lib/loggedIn.js",
    "importStyle": "{loggedIn}",
    "description": null,
    "lineNumber": 7,
    "undocument": true,
    "params": [
      {
        "name": "me",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "__docId__": 154,
    "kind": "file",
    "name": "src/lib/logger.js",
    "content": "import winston from 'winston';\n\n/*\n * Creates a logger based on winston\n * @param {object} me\n * @return {boolean} logger\n */\n\nwinston.emitErrs = true;\n\n// create timestamps in local format\nconst timestamp = function() {\n  return new Date(Date.now()).toLocaleString();\n};\n\n// format the output messages\nconst formatter = function(options) {\n  return (\n    options.timestamp() +\n    ' ' +\n    (options.level === 'error' ? ' ' + options.level.toUpperCase() : '') +\n    ' ' +\n    (options.message ? options.message : '') +\n    (options.meta && Object.keys(options.meta).length\n      ? '\\n\\t' + JSON.stringify(options.meta)\n      : '')\n  );\n};\n\n// creates the logger, which outputs messages to file and to console\nexport function logger(filename) {\n  return new winston.Logger({\n    transports: [\n      new winston.transports.File({\n        level: 'debug',\n        filename,\n        handleExceptions: true,\n        json: false,\n        maxsize: 5 * 1024 * 1024, // 5MB\n        maxFiles: 5,\n        colorize: false,\n        timestamp,\n        formatter\n      }),\n\n      new winston.transports.Console({\n        level: 'debug',\n        handleExceptions: true,\n        json: false,\n        colorize: true,\n        timestamp,\n        formatter\n      })\n    ],\n\n    exitOnError: false\n  });\n}\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/lib/logger.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 155,
    "kind": "function",
    "name": "timestamp",
    "memberof": "src/lib/logger.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/logger.js~timestamp",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/lib/logger.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "params": [],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 156,
    "kind": "function",
    "name": "formatter",
    "memberof": "src/lib/logger.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/logger.js~formatter",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/lib/logger.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 17,
    "undocument": true,
    "params": [
      {
        "name": "options",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 157,
    "kind": "function",
    "name": "logger",
    "memberof": "src/lib/logger.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/logger.js~logger",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/lib/logger.js",
    "importStyle": "{logger}",
    "description": null,
    "lineNumber": 31,
    "undocument": true,
    "params": [
      {
        "name": "filename",
        "types": [
          "*"
        ]
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 158,
    "kind": "file",
    "name": "src/lib/protectFields.js",
    "content": "import { dummyUserContext } from './dummyUserContext';\n\n/*\n * Protects a field based on authorizations\n * @param {object} me\n * @param {array} authorizedUserRoles\n * @param {array} protectedFields\n * @param {object} inputObject\n * @param {object} User\n * @return {object} result\n */\nexport function protectFields(\n  me = {},\n  authorizedUserRoles = [],\n  protectedFields = [],\n  inputObject = {},\n  { User } = { User: dummyUserContext }\n) {\n  // pure function\n  const result = Object.assign({}, inputObject);\n\n  // getting role of current User\n  const role = User.authRole(me);\n\n  // if user is not allowed to access specific fields,\n  // remove field from object...\n  if (!authorizedUserRoles.includes(role)) {\n    protectedFields.forEach(protectedField => {\n      if (result[protectedField]) {\n        delete result[protectedField];\n      }\n    });\n  }\n\n  return result;\n}\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/lib/protectFields.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 159,
    "kind": "function",
    "name": "protectFields",
    "memberof": "src/lib/protectFields.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/protectFields.js~protectFields",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/lib/protectFields.js",
    "importStyle": "{protectFields}",
    "description": null,
    "lineNumber": 12,
    "undocument": true,
    "params": [
      {
        "name": "me",
        "optional": true,
        "types": [
          "{}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      },
      {
        "name": "authorizedUserRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "protectedFields",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "inputObject",
        "optional": true,
        "types": [
          "{}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      },
      {
        "name": "objectPattern4",
        "optional": true,
        "types": [
          "{\"User\": undefined}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 160,
    "kind": "file",
    "name": "src/lib/queryForRoles.js",
    "content": "import { userRoleAuthorized } from './userRoleAuthorized';\nimport { dummyUserContext } from './dummyUserContext';\nimport { loggedIn } from './loggedIn';\nimport { authlog } from './authlog';\n\nconst defaultLogger = authlog();\n\n/*\n * Prepare a query object for mongodb operations with authorization queries\n * creates an authQuery object with additional \n * query arguments, to implement authorization restrictions for mongodb access\n * @param {object} me\n * @param {array} userRoles\n * @param {array} docRoles\n * @param {object} inputObject\n * @param {object} User\n * @param {object} logger\n * @return {object, exception} queryObject\n *\n * @example: queryForRoles(me, userRoles, docRoles, { User }, \n *                         authlog(resolver, mode, me ) ); \n */\nexport function queryForRoles(\n  me = {},\n  userRoles = [],\n  docRoles = [],\n  { User } = { User: dummyUserContext },\n  logger = defaultLogger\n) {\n  // get current User's role\n  const role = User.authRole(me);\n\n  // Build query for the case: The logged in user's role is authorized\n  if (userRoleAuthorized(me, userRoles, { User }, logger)) {\n    // empty authQuery means, do operation with no access restrictions\n    return {};\n  }\n\n  // Build query for the case: The user is listed in any document field\n  const query = { $or: [] };\n  // makes only sense, if user is logged in - otherwise no userId\n  if (loggedIn(me)) {\n    // prepare selection criterias as 'authQuery' object\n    // for later mongodb 'find(...baseQuery,  ...authQuery)'\n    //                               ...  AND ...{ field1 OR field2}\n    // which will be also considered during the database access\n    // as an '$or: [ { field1: userId}, { field2: userId} ]'\n    // with all document roles as fields for the later selection.\n    // At least one of those fields must match the userId,\n    // otherwise, whether no data found or not authorized to access data\n    docRoles.forEach(docRole => query.$or.push({ [docRole]: me._id }));\n    // return this authQuery only, if there was at least 1 field added\n    // otherwise it will result in an unlimited access\n    if (query.$or.length > 0) {\n      // for easier debugging write into the authorzation logs\n      logger.debug(\n        `and role: '${role ? role : '<no-role>'}' with \n        authQuery: ${JSON.stringify(query, null, 2)}`\n      );\n      // return the query as authQuery for later selection\n      return query;\n    }\n  }\n\n  // Not Authorized - throw exception in logger.error\n  const message = `and role: '${role}' is not authorized.`;\n  logger.error(message);\n}\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/lib/queryForRoles.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 161,
    "kind": "variable",
    "name": "defaultLogger",
    "memberof": "src/lib/queryForRoles.js",
    "static": true,
    "longname": "src/lib/queryForRoles.js~defaultLogger",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/lib/queryForRoles.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 6,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 162,
    "kind": "function",
    "name": "queryForRoles",
    "memberof": "src/lib/queryForRoles.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/queryForRoles.js~queryForRoles",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/lib/queryForRoles.js",
    "importStyle": "{queryForRoles}",
    "description": null,
    "lineNumber": 23,
    "undocument": true,
    "params": [
      {
        "name": "me",
        "optional": true,
        "types": [
          "{}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      },
      {
        "name": "userRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "docRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "objectPattern3",
        "optional": true,
        "types": [
          "{\"User\": undefined}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      },
      {
        "name": "logger",
        "optional": true,
        "types": [
          "*"
        ],
        "defaultRaw": "defaultLogger",
        "defaultValue": "defaultLogger"
      }
    ],
    "return": {
      "types": [
        "*"
      ]
    }
  },
  {
    "__docId__": 163,
    "kind": "file",
    "name": "src/lib/userRoleAuthorized.js",
    "content": "import { dummyUserContext } from './dummyUserContext';\nimport { authlog } from './authlog';\n\nconst defaultLogger = authlog();\n\n/*\n * Is a user's role authorized for a document\n * @param {object} me\n * @param {array} userRoles\n * @param {object} User\n * @param {object} logger\n * @return {boolean} authorized\n */\n\n// returns true, if the user's role is authorized for a document\nexport function userRoleAuthorized(\n  me = {},\n  userRoles = [],\n  { User } = { User: dummyUserContext },\n  logger = defaultLogger\n) {\n  // get current User's role\n  const role = User.authRole(me);\n\n  // determine, if the given userRoles authorize the current User by its role\n  if (\n    // userRole: 'world' should authorize everyone - known and unknown users\n    userRoles.includes('world') ||\n    // or there must be a userRole given, and current user must have a role\n    // and the current user's role must be in the given userRoles\n    (role && role !== '' && userRoles.length > 0 && userRoles.includes(role))\n  ) {\n    // => authorized\n    logger.debug(`and role '${role ? role : '<no-role>'}' is authorized`);\n    return true;\n  }\n\n  // => not authorized\n  return false;\n}\n",
    "static": true,
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/src/lib/userRoleAuthorized.js",
    "access": "public",
    "description": null,
    "lineNumber": 1
  },
  {
    "__docId__": 164,
    "kind": "variable",
    "name": "defaultLogger",
    "memberof": "src/lib/userRoleAuthorized.js",
    "static": true,
    "longname": "src/lib/userRoleAuthorized.js~defaultLogger",
    "access": "public",
    "export": false,
    "importPath": "create-graphql-server-authorization/src/lib/userRoleAuthorized.js",
    "importStyle": null,
    "description": null,
    "lineNumber": 4,
    "undocument": true,
    "type": {
      "types": [
        "*"
      ]
    },
    "ignore": true
  },
  {
    "__docId__": 165,
    "kind": "function",
    "name": "userRoleAuthorized",
    "memberof": "src/lib/userRoleAuthorized.js",
    "generator": false,
    "async": false,
    "static": true,
    "longname": "src/lib/userRoleAuthorized.js~userRoleAuthorized",
    "access": "public",
    "export": true,
    "importPath": "create-graphql-server-authorization/src/lib/userRoleAuthorized.js",
    "importStyle": "{userRoleAuthorized}",
    "description": null,
    "lineNumber": 16,
    "undocument": true,
    "params": [
      {
        "name": "me",
        "optional": true,
        "types": [
          "{}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      },
      {
        "name": "userRoles",
        "optional": true,
        "types": [
          "*[]"
        ],
        "defaultRaw": [],
        "defaultValue": "[]"
      },
      {
        "name": "objectPattern2",
        "optional": true,
        "types": [
          "{\"User\": undefined}"
        ],
        "defaultRaw": {},
        "defaultValue": "{}"
      },
      {
        "name": "logger",
        "optional": true,
        "types": [
          "*"
        ],
        "defaultRaw": "defaultLogger",
        "defaultValue": "defaultLogger"
      }
    ],
    "return": {
      "types": [
        "boolean"
      ]
    }
  },
  {
    "kind": "index",
    "content": "[![npm version](https://badge.fury.io/js/create-graphql-server-authorization.svg)](http://badge.fury.io/js/create-graphql-server-authorization) [![Build Status](https://travis-ci.org/tobkle/create-graphql-server-authorization.svg?branch=master)](https://travis-ci.org/tobkle/create-graphql-server-authorization) [![Coverage Status](https://coveralls.io/repos/github/tobkle/create-graphql-server-authorization/badge.svg?branch=master)](https://coveralls.io/github/tobkle/create-graphql-server-authorization?branch=master)\n\n# create-graphql-server-authorization\n\nAdds Authorization Logic to the GraphQL-Server-Generator: **create-graphql-server**.\n\nIf you are using create-grapqhl-server, you come to a point, when you need some kind of authorization on your GraphQL server. This package provides a possible way to do authorization checks.\n\nTherefore it enhances the type schema with two additional GraphQL directives:\n* @authorize\n* @authRole\n\nUse these two directives in your GraphQL type definitions. Then use the ```bash create-graphql-server add-type <your-type>``` command to generate the according GraphQL server code with already injected generated authorization logic code.\n\n## Usage\nIt provides Authorization checks for\n* document type authorization\n\nIt adds the two GraphQL directives @authorize and @authRole to the create-graphql-server type system e.g.:\n```javascript\ntype User\n@authorize(\n  admin: [\"create\", \"read\", \"update\", \"delete\"],\n  this: [\"readOne\", \"update\", \"delete\"]\n)\n{\n  username: String!\n  role: String! @authRole(for: [\"admin\"]) \n  bio: String!\n}\n```\n\n## Installation\n```bash\ngit clone git@github.com:tmeasday/create-graphql-server.git\ncd create-graphql-server\nyarn add create-graphql-server-authorization\n```\n\nAdd it to the generator files here:\n* generate/model/index.js [Mandatory]\n* generate/schema/index.js [Optional]\n\nIn the Model generator you can use it, to generate authorization code which is then injected in the Model methods of the types:\n```javascript\nimport { generateAuthorizationCode } from 'create-graphql-server-authorization';\n...\nexport function generateModelAst(inputSchema) {\n  const type = inputSchema.definitions[0];\n  const TypeName = type.name.value;\n  const typeName = lcFirst(TypeName);\n\n  const ast = generators.base({ \n    TypeName,\n    typeName,\n    ...generateAuthorizationCode( typeName, inputSchema )\n  });\n\n  ...\n}\n...\n```\n\nIt generates authorization code for the following **tags**...\n* generateAuthCodeModeReadOne\n* generateAuthCodeModeReadMany\n* generateAuthCodeModeCreate\n* generateAuthCodeModeUpdate\n* generateAuthCodeModeDelete\n* generateCreatedBy\n* generateUpdatedBy\n* generateAuthRoleDefinition\n* generateAuthRoleMethod\n\nInsert those tags at the appropriate places in the /generate/model/templates/... files.\n\nFor example:\nIf you want to use authorization logic in the update mutation: Add the tag **generateAuthCodeModeUpdate** into the /generate/model/templates/base.js.template file like so:\n\n```javascript\n...\nimport { findByIds, queryForRoles, getLogFilename, logger, authlog, checkAuthDoc, protectFields } from 'create-graphql-server-authorization';\n...\n\nasync updateById(id, doc, me, resolver) {\n  try {\n    let docToUpdate = {$set: Object.assign({}, doc, {\n          updatedAt: Date.now(),\n          updatedById: (me && me._id) ? me._id : 'unknown',\n    })};\n    const baseQuery = {_id: id};\n\n\t// here at this location:\n    generateAuthCodeModeUpdate\n\n    const result = await this.collection.updateOne(finalQuery, docToUpdate);\n    if (result.result.ok !== 1 || result.result.n !== 1){\n      throw new Error(`update typeName not possible for ${id}.`);\n    }\n    log.debug(`updated typeName ${id}.`);\n    this.authorizedLoader.clear(id);\n    const updatedDoc = this.findOneById(id, me, 'pubsub typeNameUpdated');\n    this.pubsub.publish('typeNameUpdated', updatedDoc);\n    return updatedDoc;\n  } catch (err) { log.error(err.message); }\n}\n\n...\n```\n\nHere is a complete example file for generate/model/templates/base.js.template:\n```javascript\nimport DataLoader from 'dataloader';\nimport { findByIds, queryForRoles, getLogFilename, logger, authlog, checkAuthDoc, protectFields } from 'create-graphql-server-authorization';\nconst log = logger(getLogFilename());\n\nexport default class TypeName {\n  constructor(context) {\n    this.context = context;\n    this.collection = context.db.collection('typeName');\n    this.pubsub = context.pubsub;generateAuthRoleDefinition\n    const that = this;\n    try {\n      generateAuthCodeModeReadOne\n    } catch (err) { log.error(err.message); }\n  }\n  generateAuthRoleMethod\n  async findOneById(id, me, resolver) {\n    try {\n      if (!this.authorizedLoader) return null;\n      return await this.authorizedLoader.load(id);\n    } catch (err) { log.error(err.message); }\n  }\n\n  find({ lastCreatedAt = 0, limit = 10, baseQuery = {} }, me, resolver) {\n    try {\n      generateAuthCodeModeReadMany\n      return this.collection.find(finalQuery).sort({ createdAt: 1 }).limit(limit).toArray();\n    } catch (err) { log.error(err.message); }\n  }\n\n  generateCreatedBy\n\n  generateUpdatedBy\n\n  async insert(doc, me, resolver) {\n    try {\n      let docToInsert = Object.assign({}, doc, {\n        createdAt: Date.now(),\n        updatedAt: Date.now(),\n        createdById: (me && me._id) ? me._id : 'unknown',\n        updatedById: (me && me._id) ? me._id : 'unknown',\n      });\n      generateAuthCodeModeCreate\n      const id = (await this.collection.insertOne(docToInsert)).insertedId;\n      if (!id) {\n        throw new Error(`insert typeName not possible.`);\n      }\n      log.debug(`inserted typeName ${id}.`);\n      const insertedDoc = this.findOneById(id, me, 'pubsub typeNameInserted');\n      this.pubsub.publish('typeNameInserted', insertedDoc);\n      return insertedDoc;\n    } catch (err) { log.error(err.message); }\n  }\n\n  async updateById(id, doc, me, resolver) {\n    try {\n      let docToUpdate = {$set: Object.assign({}, doc, {\n            updatedAt: Date.now(),\n            updatedById: (me && me._id) ? me._id : 'unknown',\n      })};\n      const baseQuery = {_id: id};\n      generateAuthCodeModeUpdate\n      const result = await this.collection.updateOne(finalQuery, docToUpdate);\n      if (result.result.ok !== 1 || result.result.n !== 1){\n        throw new Error(`update typeName not possible for ${id}.`);\n      }\n      log.debug(`updated typeName ${id}.`);\n      this.authorizedLoader.clear(id);\n      const updatedDoc = this.findOneById(id, me, 'pubsub typeNameUpdated');\n      this.pubsub.publish('typeNameUpdated', updatedDoc);\n      return updatedDoc;\n    } catch (err) { log.error(err.message); }\n  }\n\n  async removeById(id, me, resolver) {\n    try {\n      const baseQuery = {_id: id};\n      generateAuthCodeModeDelete\n      const result = await this.collection.remove(finalQuery);\n      if (result.result.ok !== 1 || result.result.n !== 1){\n        throw new Error(`remove typeName not possible for ${id}.`);\n      }\n      log.debug(`removed typeName ${id}.`);\n      this.authorizedLoader.clear(id);\n      this.pubsub.publish('typeNameRemoved', id);\n      return result;\n    } catch (err) { log.error(err.message); }\n  }\n\n}\n```\n\nAdditional references for this module **create-graphql-server-authorization** in the create-graphql-server are here:\n* /skel/server/authenticate.js [uses: findByIds]\n* /skel/server/index.js [uses: getLogFilename, logger]\n\nSo if you are replacing **create-graphql-server-authorization** by your own forked version of this module, please don't forget the other two references, or just keep the original version in your package.json.\n\n### Option\nIn the Schema generator you can use it as an option for example, to generate two fields createdBy and updatedBy only if there is a user type and authorization setup:\n```javascript \nimport { isAuthorizeDirectiveDefined } from 'create-graphql-server-authorization';\n...\nconst authorize = isAuthorizeDirectiveDefined(outputSchema);\n...\n// for safety reasons:\n// only with @authorize we know that there is a \"User\" type defined\nif (authorize){\n  type.fields.push(buildField('createdBy', [], 'User'));\n  type.fields.push(buildField('updatedBy', [], 'User'));\n}\n...\n```\n\n## Tests\n```bash\nnpm run test\n```\n\n## Contributing\nIn lieu of a formal style guide, take care to maintain the existing coding style. Add unit tests for any new or changed functionality. Lint and test your code.\n\n",
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/README.md",
    "name": "./README.md",
    "static": true,
    "access": "public"
  },
  {
    "kind": "packageJSON",
    "content": "{\n  \"name\": \"create-graphql-server-authorization\",\n  \"version\": \"0.0.28\",\n  \"description\": \"Authorization package for create-graphql-server\",\n  \"contributors\": [\n    \"Tobias Klemmer <tobias@klemmer.info> (https://www.klemmer.info)\"\n  ],\n  \"main\": \"index.js\",\n  \"author\": \"Tobias Klemmer <tobias@klemmer.info> (https://www.klemmer.info)\",\n  \"license\": \"MIT\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://github.com/tobkle/create-graphql-server-authorization.git\"\n  },\n  \"keywords\": [\n    \"create-graphql-server\",\n    \"authorization\"\n  ],\n  \"bugs\": {\n    \"url\": \"https://github.com/tobkle/create-graphql-server-authorization/issues\"\n  },\n  \"config\": {\n    \"logfile\": \"log/all-logs-readable.log\"\n  },\n  \"options\": {\n    \"mocha\": \"--require ./resources/mocha-bootload --check-leaks --full-trace src/**/__tests__/**/*-test.js\"\n  },\n  \"scripts\": {\n    \"test\": \"npm run lint && npm run check && npm run testonly\",\n    \"testonly\": \"babel-node ./node_modules/.bin/_mocha $npm_package_options_mocha\",\n    \"t\": \"babel-node ./node_modules/.bin/_mocha --require ./resources/mocha-bootload\",\n    \"lint\": \"eslint --fix src || (printf '\\\\033[33mTry: \\\\033[7m npm run lint -- --fix \\\\033[0m\\\\n' && exit 1)\",\n    \"check\": \"flow check\",\n    \"check-cover\": \"for file in {src/*.js,src/**/*.js}; do echo $file; flow coverage $file; done\",\n    \"build\": \"babel src --optional runtime --ignore __tests__ --out-dir dist/ && cp package.json dist/ && npm run build-dot-flow\",\n    \"build-dot-flow\": \"find ./src -name '*.js' -not -path '*/__tests__*' | while read filepath; do cp $filepath `echo $filepath | sed 's/\\\\/src\\\\//\\\\/dist\\\\//g'`.flow; done\",\n    \"watch\": \"babel-node ./resources/watch.js\",\n    \"cover\": \"babel-node ./node_modules/.bin/isparta cover --root src --report html _mocha -- $npm_package_options_mocha\",\n    \"cover:lcov\": \"babel-node ./node_modules/.bin/isparta cover --root src --report lcovonly _mocha -- $npm_package_options_mocha\",\n    \"preversion\": \". ./resources/checkgit.sh && npm test\",\n    \"prepublish\": \". ./resources/prepublish.sh\",\n    \"gitpublish\": \". ./resources/gitpublish.sh\",\n    \"prettier\": \"node_modules/.bin/prettier src/**/**/*.js --write\",\n    \"esdoc\": \"node_modules/.bin/esdoc -c esdoc.json\"\n  },\n  \"homepage\": \"https://github.com/tobkle/create-graphql-server-authorization#readme\",\n  \"devDependencies\": {\n    \"babel-cli\": \"6.24.1\",\n    \"babel-eslint\": \"7.2.3\",\n    \"babel-plugin-syntax-async-functions\": \"6.13.0\",\n    \"babel-plugin-syntax-async-generators\": \"6.13.0\",\n    \"babel-plugin-transform-class-properties\": \"6.24.1\",\n    \"babel-plugin-transform-flow-strip-types\": \"6.22.0\",\n    \"babel-plugin-transform-object-rest-spread\": \"6.23.0\",\n    \"babel-preset-env\": \"^1.5.2\",\n    \"bson-objectid\": \"^1.1.5\",\n    \"chai\": \"4.1.1\",\n    \"chai-fs\": \"^1.0.0\",\n    \"chai-json-equal\": \"0.0.1\",\n    \"chai-spies-next\": \"^0.8.0\",\n    \"chai-subset\": \"1.5.0\",\n    \"coveralls\": \"^2.13.1\",\n    \"cross-env\": \"^5.0.5\",\n    \"dataloader\": \"^1.3.0\",\n    \"esdoc\": \"^1.0.1\",\n    \"esdoc-ecmascript-proposal-plugin\": \"^1.0.0\",\n    \"esdoc-standard-plugin\": \"^1.0.0\",\n    \"eslint\": \"^4.5.0\",\n    \"eslint-config-prettier\": \"^2.3.0\",\n    \"eslint-config-react-app\": \"^2.0.0\",\n    \"eslint-plugin-babel\": \"4.1.2\",\n    \"eslint-plugin-flowtype\": \"2.35.0\",\n    \"eslint-plugin-import\": \"^2.7.0\",\n    \"eslint-plugin-prettier\": \"^2.1.2\",\n    \"eslint-plugin-react\": \"^7.3.0\",\n    \"flow-bin\": \"0.52.0\",\n    \"isparta\": \"4.0.0\",\n    \"mocha\": \"3.5.0\",\n    \"mocha-lcov-reporter\": \"^1.3.0\",\n    \"mongo-mock\": \"^2.4.1\",\n    \"prettier\": \"^1.5.3\",\n    \"sane\": \"2.0.0\"\n  },\n  \"dependencies\": {\n    \"global\": \"^4.3.2\",\n    \"iterall\": \"^1.1.0\",\n    \"lodash\": \"4.16.4\",\n    \"mongodb\": \"^2.2.31\",\n    \"winston\": \"^2.3.1\"\n  }\n}\n",
    "longname": "/Users/Toby/MICRO/create-graphql-server-authorization/package.json",
    "name": "package.json",
    "static": true,
    "access": "public"
  }
]